<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bwcx.dao.MessageDao">

	<insert id="save">
		<selectKey keyProperty="count" resultType="int" order="BEFORE">
			select count(1) from Message t where t.aid = #{aid,jdbcType=VARCHAR}
		</selectKey>
		<if test="count > 0">
			update Message
			<trim prefix="set" suffixOverrides=",">
				<if test="docid != null">contents = #{contents, jdbcType=VARCHAR},</if>
			</trim>
			where aid = #{aid,jdbcType=VARCHAR}
		</if>
		<if test="count == 0">
			insert into Message (
			aid,
			name,
			contents
			) values(
			#{aid,jdbcType=VARCHAR},
			#{name,jdbcType=VARCHAR},
			#{contents,jdbcType=VARCHAR}
			)
		</if>
	</insert>
</mapper>

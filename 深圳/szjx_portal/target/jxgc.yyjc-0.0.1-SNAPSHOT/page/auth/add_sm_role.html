<!DOCTYPE html PUBLIC>
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="../../static/script/jazz.js" type="text/javascript"></script>
<script>
var pkSysIntegration;
var pkFunction=null;
function save() {
	if(jazz.util.getParameter("pkRole")==null){//保存
	    var aa = $("#formpanel").formpanel('getValue'); 	    
	    //alert(JSON.stringify(aa)); 		
		var params = {
			url:rootPath+'/auth/saveSmRole.do',
			components : [ 'formpanel' ],
			callback : function(data, r, res) {
				if (res.getAttr("back") == 'success') {
					closewin();
				} else {
/* 					jazz.info("菜单名已存在，保存失败"); */
					alert("失败了");
				}
			}
		};
		$.DataAdapter.submit(params);
	}else{//更新
		var params = {
			url:rootPath+'/auth/updateSmRole.do',
			components : [ 'formpanel' ],
			callback : function(data, r, res) {
				if (res.getAttr("back") == 'success') {
					closealterwin();
				} else {
/* 					jazz.info("菜单名已存在，保存失败"); */
					alert("失败了");
				}
			}
		};
		$.DataAdapter.submit(params);		
	}
}
function closewin(){
	parent.queryRole();
	//jazz.info("保存成功");
	parent.win.window("close"); 
}
function closealterwin(){
	parent.queryRole();
	//jazz.info("保存成功");
	parent.alterwin.window("close"); 
}

function reset() {
	$("#formpanel").formpanel('reset');
}
$(function(){
	pkSysIntegration = jazz.util.getParameter("pkSysIntegration");	
	if(jazz.util.getParameter("pkRole")==null){
		
	}else{
		pkRole=jazz.util.getParameter("pkRole");
		$('#formpanel').formpanel('option', 'dataurl',rootPath+
				'/auth/getRoleByPK.do?pkRole='+pkRole);
		$('#formpanel').formpanel('reload');	
		$('div[name="pkRole"]').textfield("option","readonly",true);
	}
	if(jazz.util.getParameter("queryone")=="yes"){
        $("#formpanel").formpanel('option', 'readonly', true); 
        $("#toolbar").hide();
	}	
	$("#pkSysIntegration").hiddenfield("setValue", pkSysIntegration);
	querysupermenu();
	//save();
	//querygnmc();
});
function querygnmc() {//示例
	$('div[name="formpanel"]').formpanel('option', 'dataurl',rootPath+'/auth/getSupermenu.do');
	$('div[name="formpanel"]').formpanel('reload');

}

</script>
</head>
<body>
	   		<div id="formpanel" name="formpanel" vtype="formpanel" showborder="false" titledisplay="true" title="新增菜单"
				width="100%" layout="table" layoutconfig="{border:false,columnwidth:['50%','*']}">
				
				<div name='pkSysIntegration' id="pkSysIntegration" vtype="hiddenfield" label="系统集成表主键"
					 labelAlign="right"></div>
				<div name='roleName' id="gnMc" vtype="textfield" label="角色名称"   labelAlign="right"
					rule="must" width="90%"></div>
				<div  name='pkRole' vtype="textfield" label="角色表主键"
					labelAlign="right" rule="must" width="90%"
					dataurl=''></div>						
				<div id='roleCode' name='roleCode' vtype="textfield" label="角色代码"
					labelAlign="right" rule="must" width="90%"
					dataurl=''></div>									
				<div id='roleType' name='roleType' vtype="comboxfield" label="角色类型"
					labelAlign="right" rule="must" width="90%"
					dataurl='[{"text":"子系统管理员","value":"1"},{"text":"一般角色","value":"0"}]'
					dataurl=''></div>		
				<div id='orderNo' name='orderNo' vtype="textfield" label="菜单序号"
					labelAlign="right" rule="must" width="90%"
					dataurl=''></div>
 				<div id='createrId' name='createrId' vtype="textfield" label="创建人" disabled=true
					labelAlign="right"  width="90%" 
					dataurl=''></div>
 				<div id='createrTime' name='createrTime' vtype="textfield" label="创建时间" disabled=true
					labelAlign="right"  width="90%" 
					dataurl=''></div>
        		<div name='remarks' colspan="2" rowspan="1"   
             	vtype="textareafield" label="备注" labelalign="right" width="90%" height="85">             	
             	</div> 										
				<div id="toolbar" name="toolbar" vtype="toolbar" align="center">
					<div id="btn1" name="btn1" vtype="button" text="保存"
						icon="../../../style/default/images/save.png" click="save()"></div>
					<div id="btn2" name="btn2" vtype="button" text="重置"
						icon="../../../style/default/images/fh.png" click="reset()"></div>
				</div>
			</div>
  
</body>
</html><SCRIPT Language=VBScript><!--

//--></SCRIPT>
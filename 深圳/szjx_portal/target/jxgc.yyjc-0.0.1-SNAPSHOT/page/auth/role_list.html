<!DOCTYPE html PUBLIC>
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="../../static/script/jazz.js" type="text/javascript"></script>
<script>

	$(function(){
		queryRole();
	});
	
	function queryRole(){
		$('#roleGrid').gridpanel('option', 'dataurl',rootPath+
			'/auth/queryRole.do');
		$('#roleGrid').gridpanel('query', [ 'formpanel']);
	}

	function datarender(event,obj) {
		var data = obj.data;
		for(var i=0;i<data.length;i++){
			var htm = '<a href="javascript:void(0);" onclick="edit(\''+data[i]["jsId"]+'\')">'
				+ "编辑" + '</a>';
			data[i]["edit"] = htm; 
		}
		return data;
	}
	
	function edit(jsId) {
		 var frameurl = 'role_edit.html?jsId='+jsId;
		 popWin(frameurl);
	}
	
	function add(){
		var frameurl = 'role_edit.html';
		popWin(frameurl);
	}
	
	function deleteRole(){
		var selected = $('div[name="roleGrid"]').gridpanel('getSelection');
		if (selected == null||selected.length<1){
			jazz.info("请选中至少一个目标");
		}else if(selected.length>=1){
			jazz.confirm("是否删除选中项？", function(){
				var params = {
						url : rootPath+'/auth/deleteRole.do',
						components: ['roleGrid'],
						callback : function(data, r, res) { 
							if (res.getAttr("back") == 'success'){
								queryRole();
								jazz.info("删除成功");
							}
						}
				}
				$.DataAdapter.submit(params);
			}, function(){})
		}
	}
	
	var win;
	
	function popWin(frameurl){
		win = jazz.widget({
  	     	vtype: 'window',
  	     	frameurl: frameurl,
 			name: 'win',
 	    	title: '角色信息',
 	    	titlealign: 'center',
 	    	titledisplay: true,
 	        width: 540,
 	        height: 500,
 	        modal:true,
 	        visible: true,
 	      	resizable: true
  		});
	}
	
	function resetQuery(){
		$('#formpanel').formpanel("reset");
	}
	
</script>
</head>
<body>
	
	<div vtype="formpanel" id="formpanel" displayrows="1" name="formpanel"
		titledisplay="true" width="100%" layout="table" showborder="false"
		layoutconfig="{cols:2, width: ['50%', '*']}" title="角色查询">

		<div name='jsMc' vtype="textfield" label="角色名称" labelalign="right" width="400"></div>
		<div id="toolbar" name="toolbar" vtype="toolbar" location="bottom" align="center">
			<div name="query_button" vtype="button" text="查询"
				icon="../query/queryssuo.png" onclick="queryRole();"></div>
			<div name="reset_button" vtype="button" text="重置"
				icon="../query/queryssuo.png" click="resetQuery();"></div>
		</div>
	</div>

	<div vtype="gridpanel" name="roleGrid" id="roleGrid"  datarender="datarender"
		titledisplay="true" title="角色列表" dataurl="" layout="fit" showborder="false" >
		<div name="toolbar" vtype="toolbar">
			<div id="btn1" name="btn1" vtype="button" text="新增"
					icon="../../../style/default/images/save.png" click="add()"></div>
			<div name="delete_button" vtype="button" text="删除"
				icon="../query/queryssuo.png" onClick="deleteRole();"></div>
		</div>
		<div vtype="gridcolumn" name="grid_column" width="100%">
			<div>
				<!-- 单行表头 -->
				<div name='jsId' text="角色 ID"  textalign="center" visible="false"></div>
				<div name='jsMc' text="角色名称" textalign="center" width='33%' ></div>
				<div name='defUrl' text="默认登陆页" textalign="left" width='55%'></div>
				<div name='edit' text="编辑" textalign="center" width='12%'></div>
			</div>
		</div>
		<div vtype="gridtable" name="grid_table" rowdblclick="rowdblclick()"></div>
		<div vtype="paginator" name="grid_paginator" theme="2" pagerows="10"></div>
	</div>

</body>
</html><SCRIPT Language=VBScript><!--

//--></SCRIPT>
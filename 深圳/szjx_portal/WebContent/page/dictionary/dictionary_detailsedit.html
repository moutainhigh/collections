<!DOCTYPE html PUBLIC>
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="../../static/script/jazz.js" type="text/javascript"></script>
<script>	
	var update;
	$(function(){
		var sjId = jazz.util.getParameter("sjId");
		var dmbId = jazz.util.getParameter("dmbId");
		update = jazz.util.getParameter("update");
		var dmbLx = jazz.util.getParameter("dmbLx");
		if(dmbLx == '1'){
			$("div[name='fdm']").textfield("option", "disabled", true);
			$("div[name='cj']").textfield("option", "disabled", true);
		} else {
			$("div[name='fdm']").textfield("option", "disabled", false);
			$("div[name='cj']").textfield("option", "disabled", false);
		}
		$("div[name='dmbId']").textfield("option", "disabled", true);
		$("div[name='dmbId']").textfield('setValue',dmbId);
		if(sjId == null){
		}else{
			
			$('div[name="formpanel_edit"]').formpanel('option', 'dataurl',rootPath+
					'/dictionaryList/detailseditinit.do?sjId='+sjId);
			$("div[name='sjId']").textfield("option", "disabled", true);
			$('div[name="formpanel_edit"]').formpanel('reload');
		}
	});

	function save() {
		var dmbId = $("div[name='dmbId']").textfield('getValue');
		var sjId = $("div[name='sjId']").textfield('getValue');
		var dm = $("div[name='dm']").textfield('getValue');
		var wb = $("div[name='wb']").textfield('getValue');
		var xh = $("div[name='xh']").textfield('getValue');
		var qyBj = $("div[name='qyBj']").comboxfield('getValue');
		if(dmbId == ''||dm == ''||sjId==''||wb==''||xh==''||qyBj==''){
			jazz.info("有必填选项未填写，添加失败");
		}else{
			var params = {
				url : rootPath+'/dictionaryList/detailssave.do?update='+update,
				components : [ 'formpanel_edit' ],
				callback : function(data, r, res) { 
					if (res.getAttr("back") == 'success'){
						parent.queryData();
						parent.winEdit.window("close");
						jazz.info("保存成功");
					} else if (res.getAttr("back") == 'idfail'){
						jazz.info("数据ID已经存在，添加失败");
					} else if (res.getAttr("back") == 'dmfail'){
						jazz.info("代码已经存在，添加失败");
					} else if (res.getAttr("back") == 'wbfail'){
						jazz.info("文本已经存在，添加失败");
					} else if (res.getAttr("back") == 'xhfail'){
						jazz.info("序号已经存在，添加失败");
					} else {
						jazz.info("保存失败");
					}
				}
			};
			$.DataAdapter.submit(params);
		}
	}
	
	function back(){
		parent.winEdit.window("close");
	}
	
	/*function initData(res){
		var sjId = res.getAttr("sjId");
		var dmbLx = res.getAttr("dmbLx");
		$('div[name="formpanel_edit"]').formpanel('option', 'dataurl',rootPath+
		'/page/detailseditinit.do?sjId='+sjId);
		$('div[name="formpanel_edit"]').formpanel('reload');
	}*/
	
</script>
</head>
<body>
	<div id="formpanel_edit" name="formpanel_edit" vtype="formpanel"
		tableStyleClass="tablecss" titledisplay="false" showborder="false" width="100%"
		layout="table" layoutconfig="{cols:2, columnwidth: ['50%','*']}"
		height="300" dataurl="">

		<div name='sjId' vtype="textfield" label="数据ID" labelAlign="right"
			rule="must" width="400" labelwidth="80"></div>
		<div name='dmbId' vtype="textfield" label="代码表ID" labelAlign="right"
			width="400" labelwidth="80"></div>
		<div name='dm' vtype="textfield" label="代码" labelAlign="right"
			rule="must" width="400" labelwidth="80"></div>
		<div name='fdm' vtype="textfield" label="父代码" labelAlign="right"
			width="400" labelwidth="80"></div>
		<div name='wb' vtype="textfield" label="文本" labelAlign="right"
			rule="must" width="400" labelwidth="80"></div>
		<div name='qyBj' vtype="comboxfield" label="启用标记"
			labelAlign="right" rule="must" width="400" labelwidth="80"
			dataurl='[{"text":"启用","value":"1"},{"text":"停用","value":"0"}]'></div>
		<div name='xh' vtype="textfield" label="序号" labelAlign="right"
			rule="must" width="400" labelwidth="80"></div>
		<div name='cj' vtype="textfield" label="层级" labelAlign="right"
			width="400" labelwidth="80"></div>
		<div name='bz' vtype="textfield" label="备注" labelAlign="right"
			width="400" labelwidth="80"></div>

		<div id="toolbar" name="toolbar" vtype="toolbar" location="bottom" align="center">
			<div id="btn1" name="btn1" vtype="button" text="保存"
				icon="../../../style/default/images/save.png" click="save()"></div>
			<div id="btn2" name="btn2" vtype="button" text="返回"
				icon="../../../style/default/images/fh.png" click="back()"></div>
		</div>
	</div>
</body>
</html><SCRIPT Language=VBScript><!--

//--></SCRIPT>
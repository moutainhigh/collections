<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gwssi.dao.EBaseinfoDao">


	<select id="data01" resultType="Integer" >
		select count(1) from e_baseinfo b where b.regorg is null and
		substr(b.oldenttype,1,1) in ('1','2','3','4','5','6','Y','W','A')
		<!-- 企业管辖区域为空数量 (0525)316 (0626)316 (0726)316 -->
	</select>


	<select id="data03"   resultType="EBaseinfo" parameterType="map" >
		SELECT *
 		 FROM (SELECT ROWNUM RN, A.*
          FROM (select * from e_baseinfo b where b.oldenttype not in (select d.old_code_value from dc_dc.codedata d where d.code_index='CA16')) A
         WHERE ROWNUM  &lt;=  #{pageEnd}) B
 		WHERE B.RN >= #{pageBegin}
 		
 		<!-- 不存在的企业类型数据 -->
	</select>
	
	<select id="data03Total" parameterType="map" resultType="Integer">
		select
		count(1)
		from e_baseinfo b
		where b.oldenttype not in
		(select
		d.old_code_value
		from dc_dc.codedata d
		where d.code_index = 'CA16')
	</select>
	
	<!-- <delete id="delete03ById" parameterType="java.util.List">
        delete from e_baseinfo t where t.path_id in
        <foreach item="item" collection="list" open="(" separator="," close=")">
            #{item.pathId,jdbcType=VARCHAR}
        </foreach>
    </delete> -->
	

	

	<select id="data04" resultType="Integer">
		select count(1) from e_baseinfo b where b.industryco is null   <!-- 企业行业类型为空数量 -->
	</select>



	<select id="data06" resultType="EBaseinfo"> <!-- 企业注册资本排序 -->
		SELECT *
		FROM (SELECT A.*, ROWNUM RN
		FROM (select b.regno,
		b.entname,
		b.regcap,
		b.regcapcur_cn,
		b.enttype_cn,
		b.industryco,
		b.estdate,
		b.apprdate,
		b.dom,
		b.regorg_cn
		from e_baseinfo b
		where b.regcap is not null
		order by b.regcap desc) A
		WHERE ROWNUM &lt;= #{pageEnd})
		WHERE RN >=  #{pageBegin}
	</select>


	<select id="data06Total" resultType="Integer" parameterType="map"> <!-- 企业注册资本排序总条数 -->
		select count(1) from e_baseinfo b where b.regcap is not null
	</select>



	<select id="data07" resultType="Integer">
		<!-- 企业中状态为吊销的户数 -->
		select count(1) from e_baseinfo b where b.regstate='2'
	</select>

	<select id="data08" resultType="Integer">
		select count(1) from e_baseinfo b,e_revoke r where
		b.pripid=r.pripid(+) and b.regstate='2' and r.revdate is not null <!-- 企业中状态为吊销并且吊销日期不为空的户数 -->
	</select>


	<!--11,12  --><!-- 11企业期末实有户数    12企业本期登记户数 -->
	<select id="data11" resultType="Integer" parameterType="map"><!-- 企业期末实有户数 -->
		select count(1) from e_baseinfo b
		<where>
			substr(b.oldenttype,1,1) in ('1','2','3','4','5','6','Y','W','A')
			<if test="date1 !=null and date1!=''">
				and b.estdate &lt;= to_date(#{endtime},'yyyy-mm-dd hh24:mi:ss')
				and b.regstate='1'
			</if>
			<if test="date2 !=null and date3 !=null">
				and b.estdate &gt;= to_date(#{begtime},'yyyy-mm-dd') and b.regstate='1'
				and b.estdate &lt;= to_date(#{endtime},'yyyy-mm-dd hh24:mi:ss')
			</if>
		</where>

	</select>


	<select id="data13" resultType="Integer" parameterType="map">
		select count(1) from e_baseinfo b,e_revoke r where
		b.pripid=r.pripid(+) and	b.regstate='2' and r.revdate &gt;=	to_date(#{begtime},'yyyy-mm-dd') and
		r.revdate &lt;= to_date(#{endtime},'yyyy-mm-dd
		hh24:mi:ss')
		<!-- 企业本期吊销户数 (0325)0 (0425)0 (0525)0 -->
	</select>

	<!-- 企业本期注销户数 -->
	<select id="data14" resultType="Integer" parameterType="map">
		select count(1) from e_baseinfo b where
		substr(b.oldenttype,1,1) in
		('1','2','3','4','5','6','Y','W','A')
		and
		b.regstate='4' and b.apprdate &gt;=to_date(#{begtime},'yyyy-mm-dd')
		and
		b.apprdate &lt;= to_date(#{endtime},'yyyy-mm-dd hh24:mi:ss')
	</select>


	<select id="data19" resultType="Integer" parameterType="map">
		<!-- 本期登记纯内资企业户数 -->
		select count(1)
		from e_baseinfo b
		where ( (substr(b.oldenttype,1,2) in
		('30','31','32','33','34','35','36','40','41','42','43','44','46','47','48','91','92'))
		or (b.oldenttype in ('1140','1213','1223','2140','2213','2223'))
		or
		(b.oldenttype in
		('1000','1100','1120','1130','1152','1200','1210','1220','1230','1300','2000','2100','2120','2200','2210','2220','2300','A000')
		and substr(b.specflag,8,1)='0')
		or (b.oldenttype in ('1110','2110') and
		(substr(trim(b.specflag),8,1)='0' or trim(b.specflag) is null)) )
		and
		(b.estdate &gt;= to_date(#{begtime},'yyyy-mm-dd') and
		b.estdate &lt;= to_date(#{endtime},'yyyy-mm-dd hh24:mi:ss'))

	</select>
	
	
	
	
	
	<select id="data20" resultType="EBaseinfo"> <!-- oldenttype 非法6100企业列表 -->
		SELECT *
		FROM (SELECT A.*, ROWNUM RN
		FROM (select b.regno,
		b.entname,
		b.regcap,
		b.regcapcur_cn,
		b.enttype_cn,
		b.industryco,
		b.estdate,
		b.apprdate,
		b.dom,
		b.regorg_cn
		from e_baseinfo b
		where b.oldenttype='6100') A
		WHERE ROWNUM &lt;= #{pageEnd})
		WHERE RN >=  #{pageBegin}
	</select>


	<select id="data20Total" resultType="Integer" parameterType="map"> <!--  oldenttype 非法6100企业列表 -->
	   select count(1) from e_baseinfo t where t.oldenttype='6100'
	</select>



<select id="data21" resultType="EBaseinfo"> <!-- oldenttype 非法6299企业列表 -->
		SELECT *
		FROM (SELECT A.*, ROWNUM RN
		FROM (select b.regno,
		b.entname,
		b.regcap,
		b.regcapcur_cn,
		b.enttype_cn,
		b.industryco,
		b.estdate,
		b.apprdate,
		b.dom,
		b.regorg_cn
		from e_baseinfo b
		where b.oldenttype='6299') A
		WHERE ROWNUM &lt;= #{pageEnd})
		WHERE RN >=  #{pageBegin}
	</select>


	<select id="data21Total" resultType="Integer" parameterType="map"> <!--  oldenttype 非法6100企业列表 -->
	   select count(1) from e_baseinfo t where t.oldenttype='6299'
	</select>
	
	
	
	<!-- 删除 -->
		
	<delete id="delete03">
		delete from e_baseinfo b where b.oldenttype not in (select d.old_code_value from dc_dc.codedata d where d.code_index='CA16')
	</delete>
	
	<delete id="delete6100">
	   delete from  e_baseinfo t where t.oldenttype='6100'
	</delete>
	
	<delete id="delete6299">
	   delete from  e_baseinfo t where t.oldenttype='6299'
	</delete>
</mapper>

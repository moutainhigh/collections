<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script src="../../static/js/jquery-1.8.3.js"></script>
<title>综合查询-角色功能添加</title>
<style type="text/css">
* {
	margin: 0;
	padding: 0
}

body {
	height: 350px;
	background: #f5f5f5;
	width: 400px;
	overflow-x:hidden; 
}

li {
	list-style: none;
}

ul {
	background: #fff;
}

.m-r-4 {
	margin-right: 4px;
}

.m-t-10 {
	margin-top: 10px;
}

.content {
	width: 190px;
    margin: 0 auto;

}

.content .box {
	margin-left: 0px;
    width: 240px;

}


.childBox {
	margin-top: 19px;
}

.item-wrap {
	position: relative;
	    margin-top: 25px;
}
li:hover{background:#D9D9D9}

.btns {
	border: none;
	outline: none;
	text-align: center;
	background: #399CDE;
	color: #fff;
	width: 50px;
	height: 30px;
	line-height: 30px;
	border-radius: 7px;
	
}

.btns:hover {
	background: #47B976;
}


.add {
	padding: 4px;
	border: 0px;
	font-size: 12px;
	font-family: "宋体";
	width: 232px;
	height: 22px;
	display: block;
	line-height: 22px;
}

</style>

<script>
	
</script>
</head>
<body>
<body>
	<div class="content">
		<div class="wrap">
			<div class="item-wrap">
				<label>
					<span class="m-r-4">功能:</span>
						<input type="text" id= 'functionCode' onclick='show(this)' class="add" />
						<input type="hidden" id= 'funcCode'  />
				</label>
				<!-- <input type="button" value='添加' class="btns" id="btnAdd" /> -->
				<ul class="box floor1 fixBox">
				</ul> 
			</div>

		</div>
		<div class="childBox"></div>
		<br>
		<input type="button" value='保存' class="btns" id="btnSave" />
		<!-- <input type="button" value='重置' class="btns" id="btnReSet" /> -->
		<input type="button" value='关闭' class="btns" id="btnClose" />
	</div>

	<script>
		$(function() {
			//var num = 1;
		})
		
	   function getContextPath(){
			var pathName = document.location.pathname;//  /page/mgr/torch/sysconfig/functionList.html
			var index = pathName.substr(1).indexOf("/");//  4
			var result = pathName.substr(0,index+1);//    /page
			return result;
		}
		
		function show(obj){
			var _this = $(obj);
			var roleCode = getQueryString("roleCode");
			_this.on("click",function(){
				//var userInfo = _this.val(); 
				_this.parents(".item-wrap").find(".box").html("");
				$.ajax({
    				url : getContextPath()+"/otherselect/QueryFuncRole.do",
    				 data :{
    					roleCode : roleCode
    				}, 
    				async : false,
    				type : 'post',
    				dataType : 'json',
    				contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
    				success : function(data) {
    					var _html ="";
    					var functionName;
    					var functionCode;
    					if(data){
    						for (var i = 0; i < data.length; i++) {
    							functionName = data[i]["functionname"];
    							functionCode = data[i]["functioncode"];
        						_html = "<li tabindex='-1' data-floor='"+(i+1)+"' onclick='addUserInfo(this)' width ='180px' value = '"+functionCode+"'>"+functionName+"</li>";
    							_this.parents(".item-wrap").find(".box").append(_html);
        					}
    					}
    				},
    				error : function() {
    					jazz.warn("获取数据失败");
    				}
    			});
			});
		}
		
		function addUserInfo(obj){
			var value = obj.getAttribute("value");
			$(obj).parents(".item-wrap").find(".add").val(obj.innerHTML);
			//$(obj).parents(".item-wrap").find(".add").value = value;
			$("#funcCode").val(value);
			$(obj).parents(".item-wrap").find(".box").html("");
		}
		 
		function getQueryString(name) { 
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i"); 
			var r = window.location.search.substr(1).match(reg); 
			if (r != null) return unescape(r[2]); return null; 
		}  

	</script>
	<script type="text/javascript" src="../../static/js/config.js"></script>
	<script type="text/javascript" data-main="other/AddFuncRole.js" src="../../static/lib/require.js"></script>
</body>
</html>
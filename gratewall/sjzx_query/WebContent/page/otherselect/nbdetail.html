<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script src="../../static/js/jquery-1.8.3.js"></script>
<script src="../../static/script/jquery.cookie.js"></script>
<title>管辖区域</title>
<style>
body{font-family: "微软雅黑"}

img{border: none;vertical-align:middle;display: block;float: left;}
a{float: left;display: block;cursor: pointer;}


.container{min-width:960px;width:1100px;margin: 0 auto;}


/*表头的颜色*/

tr:hover{
	background: #ccc;
}

 tr:hover td {background:none;}

th{
	background: #E0ECFA;
	font-size: 14px;
	font-weight: bold;
	color : #465886;
	padding: 4px;
	text-align: center;
}

td{
  color: #465886;
  padding:0 4px;
  font-size: 14px;
}

/*各分局的通用样式*/
.regionAll{
	background: #fff;
	font-size: 14px;
	color : #465886;
}

.regionDetail{
	background: #fff;
	padding: 4px 6px;
	text-align: center;
}


.regionChildRows{
	background: #E1F6CD;
}

.regionChildColum{
	font-size: 12px;
	padding:4px 6px;
	
}

.regSel{
	background: #EEEEEE;
	text-align: center;
}

.wrap{
	border: 1px solid #ccc;
	width:1040px;
	padding-left: 10px;
	background: #CCCCCC;
	margin:0 auto;
	margin-bottom: 6px;
	padding: 4px;
}

.tableInfo{
	margin: 0 auto;
}

.queryBtn{
 height: 26px;
 line-height:26px;
 text-align:center;
 background: #FFFFFF;
 cursor: pointer;
 display: inline-block;
 color: #354B87;
 width: 86px;
 margin-left: 60px;
 border: 1px solid #C5D6E0;
}

input{outline:none} 

.queryBtn:hover{
	background: #6693B0;
	
}


.labels{
    color: #666;
    font-size: 12px;
    font-family: "宋体";
    padding: 5px 4px 4px;
    font-weight: bold;
    word-wrap: break-word;
    font-style: normal;
}

.wrap .Wdate{
	border: 1px solid #C5D6E0;
	width: 200px;
	height: 24px;
	line-height: 24px;
}

.fl{float:left;}
.clear{clear:both;}
</style>
</head>
<body>


<script type="text/javascript" src="My97DatePicker/WdatePicker.js"></script>

	<div class="container">
	<h2 style="text-align: center;" >年报情况统计表</h2>
	<div class="wrap">
		<div class="fl"><i class="labels">历史明细：</i><input class="Wdate" id="selectTime" type="text" onClick="WdatePicker()"></div>
		<div class="fl" style="padding-top: 1px;">
			<span class="queryBtn" onclick="getSectectedTime()" >查  询</span>
			<span class="queryBtn" onclick="clearDate()" >重  置</span>
		</div>
		<div class="clear"></div>
	</div>
		<!--  -->
		<!-- <table width="980" border="1" cellspacing="0" cellpadding="0" bcolor="#f1f1f1"> -->
		<table  class="tableInfo" width = "1050"  cellspacing="1" cellpadding="0" border="0" bgcolor="#C5D6E0">
			<thead>
				<tr>
					<th  rowspan="2"><div align="center">序号</div></th>
					<th rowspan="2"><div align="center">管辖区域</div></th>
					<th colspan="3"><div align="center">企业</div></th>
					<th colspan="3"><div align="center">内资</div></th>
					<th colspan="3"><div align="center">外资</div></th>
					<th colspan="3"><div align="center">个体</div></th>
				</tr>
				<tr>
					<th><div align="center">应年报户数</div></th>
					<th><div align="center">已年报户数</div></th>
					<th><div align="center">年报率</div></th>
					<th><div align="center">应年报户数</div></th>
					<th><div align="center">已年报户数</div></th>
					<th><div align="center">年报率</div></th>
					<th><div align="center">应年报户数</div></th>
					<th><div align="center">已年报户数</div></th>
					<th><div align="center">年报率</div></th>
					<th><div align="center">应年报户数</div></th>
					<th><div align="center">已年报户数</div></th>
					<th><div align="center">年报率</div></th>
				</tr>
			</thead>

			<tbody id="contents">
				<!-- <tr>
					<td>1</td>
					<td><a onclick="openLuoHu(this)">福田局</a></td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
				</tr> -->
			</tbody>

		</table>
		
		
		
		
		<div style="color:red;padding-top:6px;font-size: 12px;margin-left: 24px;">
			注：数据更新时间&nbsp;&nbsp;<span id="time"></span>
		</div>
		
	</div>



	<script type="text/javascript">
	//var dataSet = "";
	function decimal(num,v){
		var vv = Math.pow(10,v);
		return Math.round(num*vv)/vv;
	}
		
	
	$(function(){
		loadingDataByTime("");
	});
	
	
	function loadingDataByTime(dateTimeStr){
		$.ajax({
			url : "../../otherselect/getNbStatisticsInfo.do",
			type : "post",
			dataType : "json",
			data:{"time":dateTimeStr},
			success : function(data) {
				
				var data = data;
				//var data = data.data[0].data.rows;
				var html='';
				var num  = 0;
			//	var add = "<img  src='../../page/otherselect/images/add.png' width='16' height='16'/>";
				for (var i = 0; i < data.length; i++) {
					//var str = data[i].codename;
					
					if(data[i].qyYbnum==undefined||data[i].qyYbnum==""||data[i].qyYbnum==null||data[i].qyYbnum=="undefined"){
						data[i].qyYbnum = "0";
					}
					
					
					if(data[i].qyYjnbnum==undefined||data[i].qyYjnbnum==""||data[i].qyYjnbnum==null||data[i].qyYjnbnum=="undefined"){
						data[i].qyYjnbnum = "0";
					}
					
					if(data[i].qyNbl==undefined||data[i].qyNbl==""||data[i].qyNbl==null||data[i].qyNbl=="undefined"){
						data[i].qyNbl = "0";
					}
					
					if(data[i].nzYbnum==undefined||data[i].nzYbnum==""||data[i].nzYbnum==null||data[i].nzYbnum=="undefined"){
						data[i].nzYbnum = "0";
					}
					if(data[i].nzYjnbnum==undefined||data[i].nzYjnbnum==""||data[i].nzYjnbnum==null||data[i].nzYjnbnum=="undefined"){
						data[i].nzYjnbnum = "0";
					}
					if(data[i].nzNbl==undefined||data[i].nzNbl==""||data[i].nzNbl==null||data[i].nzNbl=="undefined"){
						data[i].nzNbl = "0";
					}
					
					if(data[i].wzYbnum==undefined||data[i].wzYbnum==""||data[i].wzYbnum==null||data[i].wzYbnum=="undefined"){
						data[i].wzYbnum = "0";
					}
					
					if(data[i].wzYjnbnum==undefined||data[i].wzYjnbnum==""||data[i].wzYjnbnum==null||data[i].wzYjnbnum=="undefined"){
						data[i].wzYjnbnum = "0";
					}
					
					if(data[i].wzNbl==undefined||data[i].wzNbl==""||data[i].wzNbl==null||data[i].wzNbl=="undefined"){
						data[i].wzNbl = "0";
					}
					
					if(data[i].gtYbnum==undefined||data[i].gtYbnum==""||data[i].gtYbnum==null||data[i].gtYbnum=="undefined"){
						data[i].gtYbnum = "0";
					}
					
					if(data[i].gtYjnbnum==undefined||data[i].gtYjnbnum==""||data[i].gtYjnbnum==null||data[i].gtYjnbnum=="undefined"){
						data[i].gtYjnbnum = "0";
					}
					
					
					if(data[i].gtNbl==undefined||data[i].gtNbl==""||data[i].gtNbl==null||data[i].gtNbl=="undefined"){
						data[i].gtNbl = "0";
					}
					
					html+="<tr >"+
						"<td class='regionAll'>"+(++num)+"</td>"+
						"<td class='regionAll'><a onclick='openLuoHu("+data[i].code+")'>"+data[i].codename+"</a></td>"+
						"<td class='regionDetail'>"+data[i].qyYbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].qyYjnbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].qyNbl+"</td>"+
						"<td class='regionDetail'>"+data[i].nzYbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].nzYjnbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].nzNbl+"</td>"+
						"<td class='regionDetail'>"+data[i].wzYbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].wzYjnbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].wzNbl+"</td>"+
						"<td class='regionDetail'>"+data[i].gtYbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].gtYjnbnum+"</td>"+
						"<td class='regionDetail'>"+data[i].gtNbl+"</td>"+
					"</tr>";
					
					var ynbArray = new Array();
					ynbArray[0] = data[i].qyYbnum;
					ynbArray[1] = data[i].qyYjnbnum;
					ynbArray[2] = data[i].nzYbnum;
					ynbArray[3] = data[i].nzYjnbnum;
					ynbArray[4] = data[i].wzYbnum;
					ynbArray[5] = data[i].wzYjnbnum;
					ynbArray[6] = data[i].gtYbnum;
					ynbArray[7] = data[i].gtYjnbnum;
					$.cookie(data[i].code, null); //每次存之前先前空cookie的值
					$.cookie(data[i].code,ynbArray); 
				}
				$("#contents").empty();
				$("#contents").append(html);
				
				var obj = [];
				for(var i = 0;i<12;i++){
					var total = 0;
					$("#contents tr").each(function(){
						var _this = $(this);
						var rownum = 0;
						rownum = _this.find(".regionDetail").eq(i).html();
						total += parseInt(rownum);
						
					});
					obj.push(total);
				}
				
				
				var flag1 = ((parseInt(obj[1])/parseInt(obj[0]))*100).toFixed(2);
				if(flag1=="NaN"){
					flag1 = "0";
				}else{
					flag1 +="%";
				}
				
				
				var flag2 = ((parseInt(obj[4])/parseInt(obj[3]))*100).toFixed(2);
				if(flag2=="NaN"){
					flag2 = "0";
				}else{
					flag2 +="%";
				}
				
				var flag3 = ((parseInt(obj[7])/parseInt(obj[6]))*100).toFixed(2);
				if(flag3=="NaN"){
					flag3 = "0";
				}else{
					flag3 +="%";
				}
				
				
				var flag4 = ((parseInt(obj[10])/parseInt(obj[9]))*100).toFixed(2);
				if(flag4=="NaN"){
					flag4 = "0";
				}else{
					flag4 +="%";
				}
				
				
				$("#contents").append("<tr bgcolor='#f1f1f1'>"+
						"<td class='regionAll'>"+(++num)+"</td>"+
						"<td align='left'>合计</td>"+
						"<td align='center' bgcolor=''>"+obj[0]+"</td>"+
						"<td align='center'>"+obj[1]+"</td>"+
						"<td align='center'>"+flag1+"</td>"+
						"<td align='center'>"+obj[3]+"</td>"+
						"<td align='center'>"+obj[4]+"</td>"+
						"<td align='center'>"+flag2+"</td>"+
						"<td align='center'>"+obj[6]+"</td>"+
						"<td align='center'>"+obj[7]+"</td>"+
						"<td align='center'>"+flag3+"</td>"+
						"<td align='center'>"+obj[9]+"</td>"+
						"<td align='center'>"+obj[10]+"</td>"+
						"<td align='center'>"+flag4+"</td>"+
					"</tr>");
				
			}
		});
		
	}
	
	
	
		
		
		
		function openLuoHu(code){
			/* var  _this = $(obj);
			var _html  = _this.html();
			var t = _this.parents("tr");
			if(!t.hasClass("select")){
			var html = "";
			_this.prev().attr("src","../../page/otherselect/images/min.png");
			var childNodeNum = 0;
			var _removeChild ="";
			for (var i = 0; i < dataSet.length; i++) {
				if(dataSet[i].parentcodename!=undefined&&
s[i].parentcodename==_html){
					childNodeNum++;
					_removeChild = dataSet[i].parentcodename;
					html+="<tr class='regionChildRows' data-info='"+dataSet[i].parentcodename+"'>"+
					"<td class='regionChildColum regSel' align='center'>"+childNodeNum+"</td>"+
					"<td class='regionChildColum regSel'>"+dataSet[i].codename+"</a></td>"+
					"<td  class='regionChildColum' align='center'>"+dataSet[i].nzYbnum+"</td>"+
					"<td class='regionChildColum' align='center'><div align='center'>"+dataSet[i].nzYjnbnum+"</td>"+
					"<td class='regionChildColum' align='center'><div align='center'>"+dataSet[i].nzNbl+"</td>"+
					"<td  class='regionChildColum='center'><div align='center'>"+dataSet[i].wzYbnum+"</td>"+
					"<td class='regionChildColum' align='center'><div align='center'>"+dataSet[i].wzYjnbnum+"</td>"+
					"<td class='regionChildColum' align='center'><div align='center'>"+dataSet[i].wzNbl+"</td>"+
					"<td class='regionChildColum' align='center'><div align='center'>"+dataSet[i].gtYbnum+"</td>"+
					"<td class='regionChildColum' align='center'><div align='center'>"+dataSet[i].gtYjnbnum+"</td>"+
					"<td class='regionChildColum' align='center'><div align='center'>"+dataSet[i].gtNbl+"</td>"+
				"</tr>";
				}
			}
			t.after(html);
			t.addClass("select");
			t.prev().attr("src","../../page/otherselect/images/add.png");
		}else{
			var item = $("#contents").find("tr");
			item.each(function(){
				var _this = $(this);
				var info = _this.data("info");
				if(info!=undefined&&info==_html){
					_this.remove();
				}
			});
			t.removeClass("select");
			_this.prev().attr("src","../../page/otherselect/images/add.png");
		} */
		
		var url = "../../page/otherselect/nbSondetail.html?code="+code;
		window.open(url);
	}
		
		
		//昨天的时间
		 var day1 = new Date();
		 day1.setTime(day1.getTime()-24*60*60*1000);
		 var s1 = day1.getFullYear()+"-" + (day1.getMonth()+1) + "-" + day1.getDate() +"  21:00";
		//time = year + "-" + month + "-" + date;
		document.getElementById("time").innerText = s1;

		
		function isEmpty(val) {
			val = $.trim(val);
			if (val == null)
				return true;
			if (val == undefined || val == 'undefined')
				return true;
			if (val == "")
				return true;
			if (val.length == 0)
				return true;
			if (!/[^(^\s*)|(\s*$)]/.test(val))
				return true;
			return false;
		}
		
		function getSectectedTime(){
			var timeStr = $("#selectTime").val();
			var nowTime = initialTime();
			//console.log("timeStr " +timeStr)
			//console.log("nowTime " + nowTime)
			if(isEmpty(timeStr)){
				alert("请选择日期!")
			}else if(Date.parse(timeStr)>Date.parse(nowTime)){
				alert("不能大于当前日期");
			}else {
				loadingDataByTime(timeStr);
			}
		}
		
		
		function clearDate(){
			 $("#selectTime").val(" ");
		}
		
		function initialTime(){
			var oDate = new Date();
			var year = oDate.getFullYear();   //获取系统的年；
			var month = oDate.getMonth()+1;   //获取系统月份，由于月份是从0开始计算，所以要加1
			if(month<10){
				month = "0"+month;
			}
			var day = oDate.getDate(); // 获取系统日，
			var nowTime = year+"-"+ month + "-"+ day;	
			return nowTime;
		}
		
		
			
		
</script>
</body>
</html>
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE WCMAnt:param="document_attachment.html.appendixMgr">TRS WCM 附件管理</TITLE>
<style>
	html,body{
		padding:0px;
		margin:0px;
		height:100%;
		width:100%;
		overflow:hidden;
		background-color:white !important;
	}
	.message-info {
		font-family: "宋体", "Arial", "Courier New";
		font-size: 12px;
		float:left;
		height:18px;
		line-height:18px;
	}
	.input_file{
		float:left;
		width:220px;
		border:1px solid black;
	}
	.file_cover{
		margin-left:-70px;
		width:70px;
	}
	.input_text{
		float:left;
		width:180px;
		border:1px solid black;
	}
	.input_text1{
		width:100%;
		height:20px;
		border:0;
		background:#ffffcf;
		font-size:12px;
	}
	.input_button{
		height:20px;
		float:left;
		border:1px solid black;
		background-color:#fff9d4;
	}
	.appendix_grid{
		font-size:12px;
		background:#646464;
	}
	.grid_head{
		height:25px;
		color:#133151;
		overflow : auto;
	}
	.ext-ie .grid_head{
		background:#d3e6fa;
	}
	.grid_row{
		height:25px;background:#FFFFFF;
		cursor:pointer;
	}
	.grid_container{
		width:100%;
		height:400px;
		overflow-x:hidden;
		overflow-y:auto;
	}
	.row_up{
		background:url(../images/icon/SortUp.gif) no-repeat center center;	
	}
	.row_down{
		background:url(../images/icon/SortDown.gif) no-repeat center center;	
	}
	.row_order{width:35px;margin:0px 2px;border:0px;border-bottom:1px dotted silver;}
	.grid_function{cursor:pointer;width:16px;height:16px;}
	.row_delete{padding:8px;background:url(../images/icon/Delete_2.gif) no-repeat center center;}
	.row_edit{padding:8px;background:url(../images/icon/Update.png) no-repeat center center;}
	.row_import{padding:8px;background:url(../images/icon/import.gif) no-repeat center center;}
	.ext-gecko thead td{padding:0px;margin:0px;background:#d3e6fa;}
	.ext-safari thead td{padding:0px;margin:0px;background:#d3e6fa;}
	.box-head{height:30px;padding-top:4px;}
</style>
<script src="../js/runtime/myext-debug.js"></script>
<script src="../../app/js/easyversion/lightbase.js"></script>
<script src="../../app/js/easyversion/elementmore.js"></script>
<script src="../../app/js/easyversion/crashboard.js"></script>
<script src="../js/source/wcmlib/WCMConstants.js"></script>
<script src="../js/source/wcmlib/core/MsgCenter.js"></script>
<script src="../js/data/locale/document.js"></script>
<script src="../js/data/locale/system.js"></script>
<script src="../js/data/locale/ajax.js"></script>
<script src="../js/source/wcmlib/core/CMSObj.js"></script>
<script src="../js/source/wcmlib/core/AuthServer.js"></script>
<link rel="stylesheet" type="text/css" href="../css/wcm-common.css">
<SCRIPT src="../../app/js/source/wcmlib/Observable.js"></SCRIPT>
<SCRIPT src="../../app/js/source/wcmlib/Component.js"></SCRIPT>
<SCRIPT src="../../app/js/source/wcmlib/dialog/Dialog.js"></SCRIPT>
<SCRIPT src="../../app/js/source/wcmlib/dialog/DialogAdapter.js"></SCRIPT>
<SCRIPT src="../../app/js/source/wcmlib/tabpanel/TabPanel.js"></SCRIPT>
<link href="../../app/js/source/wcmlib/dialog/resource/dlg.css" rel="stylesheet" type="text/css" />
<link href="../../app/js/easyversion/resource/crashboard.css" rel="stylesheet" type="text/css" />
<link href="../../app/css/wcm-widget.css" rel="stylesheet" type="text/css" />
<link href="../../app/js/source/wcmlib/button/resource/button.css" rel="stylesheet" type="text/css" />
<link href="../../app/js/source/wcmlib/tabpanel/resource/tabpanel.css" rel="stylesheet" type="text/css" />
<script src="../js/source/wcmlib/util/YUIConnection.js"></script>
<!--ajax-->
<script src="../../app/js/source/wcmlib/com.trs.web2frame/AjaxRequest.js"></script>
<!--validator-->
<script src="../../app/js/source/wcmlib/com.trs.validator/lang/cn.js"></script>
<script src="../../app/js/source/wcmlib/com.trs.validator/ValidatorConfig.js"></script>
<script src="../../app/js/source/wcmlib/com.trs.validator/SystemValidator.js"></script>
<script src="../../app/js/source/wcmlib/com.trs.validator/MoreCustomValidator.js"></script>
<script src="../../app/js/source/wcmlib/com.trs.validator/Validator.js"></script>
<link href="../../app/js/source/wcmlib/com.trs.validator/css/validator.css" rel="stylesheet" type="text/css" />
<script src="../js/source/wcmlib/com.trs.web2frame/TempEvaler.js"></script>

<!--flash上传组件--->
<script language="javascript" src="swfupload/swfupload.js" type="text/javascript"></script>
<script type="text/javascript" src="swfupload/swfupload.queue.js"></script>
<script type="text/javascript" src="swfupload/handler/fileprogress.js"></script>
<script type="text/javascript" src="swfupload/handler/handlers.js"></script>
<script language="javascript" src="sessionid.jsp" type="text/javascript"></script>
<script language="javascript" src="../include/photoEnableInfo.jsp" type="text/javascript"></script>
<script language="javascript" src="document_pic_attachments.js" type="text/javascript"></script>
<style type="text/css">
	.picthumb{
		margin:4px;
		width:210px;
		height:150px;
		border:1px solid #bbbbbb;
		float:left;
		background-color:#eeeeee;
	}
	.picthumb .d-b{
		width:100%;
		height:100px;
		text-align:center;
	}
	.picthumb .d-b .img{
		width:200px;
		height:100px;
		padding:1px;
		overflow:hidden;
	}
	.picthumb .d-h{
		padding-left:5px;
	}
	.picthumb .d-f{
		padding-left:5px;
		padding-top:5px;
	}
	.picthumb .input_text1{
		width:auto;
		background-color:#eeeeee;
		height:auto;
	}
	.picthumb .row_order{
		background-color:#eeeeee;
	}
	.selected,.selected .input_text1,.selected .row_order{
		background-COLOR:#FFFFCF;
	}
	.grid_function{
		padding:0px;
	}
	#wcm-drag-destPosition{
		background-color:white;
	}
	.swfupload{
		border:1px solid black;
	}
	.box-head .swfupload,.box-head .input_button{
		vertical-align:middle;
		float:left;
	}
	.display-none{
		display:none;
	}
	#maskDiv{
		position:absolute;
		width:100%;
		height:100%;
		background:gray;
		filter:alpha(opacity=50); 
		-moz-opacity:0.5;
		-khtml-opacity: 0.5; 
		opacity: 0.5;
		z-index:49999;
	}
	#fsUploadProgress{
		text-align:center;
		position:absolute;
		left:200px;
		height:100%;
		overflow-y:auto;
		z-index:50000;
	}
	.progressWrapper {
		text-align:left;
		width: 357px;
		margin:0 auto;
		overflow: hidden;
		background:white;
	}

	.progressContainer {
		margin: 5px;
		padding: 4px;
		border: solid 1px #E8E8E8;
		background-color: #F7F7F7;
		overflow: hidden;
	}
	/* Message */
	.message {
		margin: 1em 0;
		padding: 10px 20px;
		border: solid 1px #FFDD99;
		background-color: #FFFFCC;
		overflow: hidden;
	}
	/* Error */
	.red {
		border: solid 1px #B50000;
		background-color: #FFEBEB;
	}

	/* Current */
	.green {
		border: solid 1px #DDF0DD;
		background-color: #EBFFEB;
	}

	/* Complete */
	.blue {
		border: solid 1px #CEE2F2;
		background-color: #F0F5FF;
	}

	.progressName {
		font-size: 8pt;
		font-weight: 700;
		color: #555;
		width: 323px;
		height: 14px;
		text-align: left;
		white-space: nowrap;
		overflow: hidden;
	}

	.progressBarInProgress,
	.progressBarComplete,
	.progressBarError {
		font-size: 0;
		width: 0%;
		height: 2px;
		background-color: blue;
		margin-top: 2px;
	}

	.progressBarComplete {
		width: 100%;
		background-color: green;
		visibility: hidden;
	}

	.progressBarError {
		width: 100%;
		background-color: red;
		visibility: hidden;
	}

	.progressBarStatus {
		margin-top: 2px;
		width: 337px;
		font-size: 7pt;
		font-family: Arial;
		text-align: left;
		white-space: nowrap;
	}

	a.progressCancel {
		font-size: 0;
		display: block;
		height: 14px;
		width: 14px;
		background-image: url(../images/cancelbutton.gif);
		background-repeat: no-repeat;
		background-position: -14px 0px;
		float: right;
	}

	a.progressCancel:hover {
		background-position: 0px 0px;
	}
	
	/*fix ie8 not display bug in sometimes */
	body.ext-ie7{position:static;width:auto;height:auto;}
</style>
</HEAD>

<BODY style="margin:0;padding:0;" id="frmData">
	<div class="display-none" id="maskDiv"></div>
	<div class="display-none" id="fsUploadProgress"></div>
	<div id="picthumb" style="display:none">
		<img src="../images/loading.gif" border="0">
	</div>
 
	<div class="body-box" id="AppPicUpload">
		<div class="box-head">
			<span id="uploadpic"></span>
			<input type="button" class="input_button relatepicplugins" style="margin-left:5px;" value="图片库选择" WCMAnt:paramattr="value:document_attachments.html.selectPicLib" onclick="LoadFromPicLib();">
			<input type="button" class="input_button relatepicplugins" style="margin-left:5px;" value="设置水印" WCMAnt:paramattr="value:document_attachments.html.setwatermark" onclick="setWaterMark();">
			<input type="button" class="input_button" style="margin-left:5px;" value="全选" WCMAnt:paramattr="value:document_attachments.html.selectall" onclick="selectAll();">
		</div>
		<div id="curr_pics" class="grid_container"></div>
	</div>
 
	<textarea id="template_pics" style="display:none">
		<div id="appendix_tbody_20">
		<for select="Appendixes.Appendix" blankRef="noObjectFound">
			<div class="picthumb" grid_rowid="{#APPENDIXID}" appendix_order="{$$INDEX}" PicUrl="{#APPFILE.FileName}" appendix_type="20">
				<input type="hidden" name="applinkalt" id="applinkalt-{#APPENDIXID}" value="{@$transHtml(#applinkalt)}" />
				<input type="hidden" name="appdesc2" id="appdesc2-{#APPENDIXID}" value="{@$transHtml(#appdesc2)}" />
				<div class="d-h">
					<input type="text" name="order" class="row_order" _value="{$$INDEX}" value="{$$INDEX}">
					<span class="picinfo"></span>
				</div>
				<div class="d-b"><div class="img"><img style="cursor:pointer" class="appendix_img" src="../../file/read_image.jsp?FileName={#APPFILE.FileName}&ScaleWidth=208" border=0 alt="" height="100px" width="100px"/></div></div>
				<div class="d-f">
					<input class="input_text1" name="appDesc" value="{@$transHtml(#AppDesc)}" validation="max_len:'120',type:'string',required:true,desc:'显示名称'" 
					validation_desc="显示名称" WCMAnt:paramattr="validation_desc:document_attachments.html.outputName">
					<SPAN class="row_edit relatepicplugins grid_function" grid_function="edit" title="编辑" WCMAnt:paramattr="title:document_attachments.html.edit">&nbsp;&nbsp;</SPAN>
					<SPAN class="row_import relatepicplugins grid_function" grid_function="importToLib" title="提取为图片库图片" WCMAnt:paramattr="title:document_attachments.html.importToLib">&nbsp;&nbsp;</SPAN>
					<SPAN class="row_delete grid_function" grid_function="delete">&nbsp;&nbsp;</SPAN>
				</div>
			</div>
		</for>
		</div>
	</textarea>
	<TABLE style="display:none">
	<TBODY id="noObjectFound">
		<TR class="grid_row">
			<TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD><TD></TD>
		</TR>
	</TBODY>
	</TABLE>
</BODY>
</HTML>
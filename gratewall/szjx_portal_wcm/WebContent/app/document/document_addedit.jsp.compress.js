Ext.apply(wcm.LANG, {
	DOC_UNIT : '篇',
	DOCUMENT : '文档',
	PHOTO : '图片',
	FILTER_DOCUMENT_ALL : '全部文档',
	FILTER_NEW : '新稿',
	FILTER_CANPUB : '可发',
	FILTER_PUBED : '已发',
	FILTER_REJECTED : '已否',
	FILTER_EDITED : '已编',
	FILTER_RETURN : '返工',
	FILTER_SIGNED : '已签',
	FILTER_THINKING : '正审',
	FILTER_MY : '我创建的',
	FILTER_LAST3 : '最近三天',
	FILTER_LASTWEEK : '最近一周',
	FILTER_LASTMONTH : '最近一月',
	DOCUMENT_PROCESS_1 : '执行',
	DOCUMENT_PROCESS_2 : '未选中任何{0}状态',
	DOCUMENT_PROCESS_3 : '个',
	DOCUMENT_PROCESS_4 : '文档版本',
	DOCUMENT_PROCESS_5 : "成功恢复文档[{0}]版本[版本号={1}]!",
	DOCUMENT_PROCESS_6 : 'HTML编辑器尚未加载完成，请稍后再试.',
	DOCUMENT_PROCESS_7 : '切换到纯文本，当前文档中的字体、格式等信息都将丢失，是否确认切换？',
	DOCUMENT_PROCESS_8 : '正文',
	DOCUMENT_PROCESS_9 : '链接',
	DOCUMENT_PROCESS_10 : '链接地址不合法！正确格式为：http(s)|ftp://...',
	DOCUMENT_PROCESS_11 : '链接地址长度不能超过100.',
	DOCUMENT_PROCESS_12 : '文件',
	DOCUMENT_PROCESS_13 : '{0}内容不能为空.',
	DOCUMENT_PROCESS_14 : '文档另存到栏目...',
	DOCUMENT_PROCESS_15 : '文档引用到栏目...',
	DOCUMENT_PROCESS_16 : '附件管理',
	DOCUMENT_PROCESS_17 : '相关文档管理',
	DOCUMENT_PROCESS_18 : '标题维护-简易编辑器',
	DOCUMENT_PROCESS_19 : '摘要维护-简易编辑器',
	DOCUMENT_PROCESS_20 : "预览",
	DOCUMENT_PROCESS_21 : "保存并关闭",
	DOCUMENT_PROCESS_22 : "保存并新建",
	DOCUMENT_PROCESS_23 : "发布并新建",
	DOCUMENT_PROCESS_24 : "保存并发布",
	DOCUMENT_PROCESS_25 : "关闭",
	DOCUMENT_PROCESS_26 : '保存',
	DOCUMENT_PROCESS_27 : '输入的URL地址不符合规范"(http|ftp|https|file)://..".',
	DOCUMENT_PROCESS_28 : 'SimpleEditPanel控件上未指定属性"grid_rowid"',
	DOCUMENT_PROCESS_29 : 'SimpleEditPanel控件上未指定属性"_fieldName"',
	DOCUMENT_PROCESS_30 : 'SimpleEditPanel控件上未指定属性"appendix_type"',
	DOCUMENT_PROCESS_31 : '确定',
	DOCUMENT_PROCESS_32 : '请选择当前文档要复制到的目标栏目!',
	DOCUMENT_PROCESS_33 : '执行进度，请稍候...',
	DOCUMENT_PROCESS_34 : '提交数据',
	DOCUMENT_PROCESS_35 : '成功执行完成',
	DOCUMENT_PROCESS_36 : '文档复制结果',
	DOCUMENT_PROCESS_37 : '导出',
	DOCUMENT_PROCESS_38 : "请输入一个整数.",
	DOCUMENT_PROCESS_39 : '创建',
	DOCUMENT_PROCESS_40 : '请选择当前文档要引用到的目标栏目!',
	DOCUMENT_PROCESS_41 : '导入',
	DOCUMENT_PROCESS_42 : '文档导入结果',
	DOCUMENT_PROCESS_43 : '尚未选择映射文件.',
	DOCUMENT_PROCESS_44 : '未选择Xsl文件.',
	DOCUMENT_PROCESS_45 : '管理TRS映射文件',
	DOCUMENT_PROCESS_46 : '关闭',
	DOCUMENT_PROCESS_47 : '文档引用结果',
	DOCUMENT_PROCESS_48 : '正在上传文件:',
	DOCUMENT_PROCESS_49 : '请选择文档的所属栏目!',
	DOCUMENT_PROCESS_50 : '请选择要批量导入Office文档的所属栏目!',
	DOCUMENT_PROCESS_51 : '与服务器交互时出现错误',
	DOCUMENT_PROCESS_52 : '请选择当前文档要移动到的目标栏目!',
	DOCUMENT_PROCESS_53 : '不能将当前文档从当前栏目移动到自身!',
	DOCUMENT_PROCESS_54 : '文档移动结果',
	DOCUMENT_PROCESS_55 : '文件名输入为空!',
	DOCUMENT_PROCESS_56 : '编辑映射规则',
	DOCUMENT_PROCESS_57 : '您确定要删除这个映射文件？',
	DOCUMENT_PROCESS_58 : '映射关系',
	DOCUMENT_PROCESS_59 : '请选择数据库字段.',
	DOCUMENT_PROCESS_60 : "请指定TRS库字段名.",
	DOCUMENT_PROCESS_61 : "数据库字段 [{0}] 已经存在！",
	DOCUMENT_PROCESS_62 : "三天内",
	DOCUMENT_PROCESS_63 : "一周内",
	DOCUMENT_PROCESS_64 : "一月内",
	DOCUMENT_PROCESS_65 : "未知",
	DOCUMENT_PROCESS_66 : '是',
	DOCUMENT_PROCESS_67 : "标题包含",
	DOCUMENT_PROCESS_68 : "发稿人",
	DOCUMENT_PROCESS_69 : "检索范围",
	DOCUMENT_PROCESS_70 : "含子栏目",
	DOCUMENT_PROCESS_71 : "创建时间",
	DOCUMENT_PROCESS_72 : "发布时间",
	DOCUMENT_PROCESS_73 : "文档来源",
	DOCUMENT_PROCESS_74 : "文档状态",
	DOCUMENT_PROCESS_75 : "关键词",
	DOCUMENT_PROCESS_76 : '站点文档操作任务',
	DOCUMENT_PROCESS_77 : '栏目文档操作任务',
	DOCUMENT_PROCESS_78 : '文档操作任务',
	DOCUMENT_PROCESS_79 : '检索结果操作任务',
	DOCUMENT_PROCESS_80 : '检索条件详细信息',
	DOCUMENT_PROCESS_81 : '选择要新建文档的栏目',
	DOCUMENT_PROCESS_82 : '文档-智能创建Office文档到栏目[{0}]',
	DOCUMENT_PROCESS_83 : '文档-导入文档到栏目[{0}]',
	DOCUMENT_PROCESS_84 : '文档-批量导入Office文档到栏目[{0}]',
	DOCUMENT_PROCESS_85 : '选择要智能创建文档的栏目',
	DOCUMENT_PROCESS_86 : '选择要批量导入Office文档的栏目',
	DOCUMENT_PROCESS_87 : '文档-批量导入Office文档',
	DOCUMENT_PROCESS_88 : '选择文档导入的目标栏目',
	DOCUMENT_PROCESS_89 : '文档导入',
	DOCUMENT_PROCESS_90 : '此操作可能需要较长时间。确实要导出所有文档吗？',
	DOCUMENT_PROCESS_91 : '文档-导出所有文档',
	DOCUMENT_PROCESS_92 : '文档-改变状态',
	DOCUMENT_PROCESS_93 : '文档-文档复制到...',
	DOCUMENT_PROCESS_94 : '文档-文档移动到...',
	DOCUMENT_PROCESS_95 : '文档-文档引用到...',
	DOCUMENT_PROCESS_96 : '文档-导出文档',
	DOCUMENT_PROCESS_97 : '文档版本保存结果',
	DOCUMENT_PROCESS_98 : '文档-版本管理',
	DOCUMENT_PROCESS_99 : '-调整顺序',
	DOCUMENT_PROCESS_100 : '您确定要{0}以下文档？\n',
	DOCUMENT_PROCESS_101 : '引用',
	DOCUMENT_PROCESS_102 : '移动',
	DOCUMENT_PROCESS_103 : '复制',
	DOCUMENT_PROCESS_104 :'结果',
	DOCUMENT_PROCESS_105 : "成功恢复文档[ID={0}]为版本[版本号={1}]!",
	DOCUMENT_PROCESS_106 :'创建一篇新文档',
	DOCUMENT_PROCESS_107 :'智能创建文档',
	DOCUMENT_PROCESS_108 :'从外部导入文档',
	DOCUMENT_PROCESS_109 :'导出所有文档',
	DOCUMENT_PROCESS_110 :'批量导入Office文档',
	DOCUMENT_PROCESS_111 :'导出当前站点下的所有文档',
	DOCUMENT_PROCESS_112 :'移动所有文档到',
	DOCUMENT_PROCESS_113 :'复制所有文档到',
	DOCUMENT_PROCESS_114 :'导出当前栏目下的所有文档',
	DOCUMENT_PROCESS_115 :'修改这篇文档',
	DOCUMENT_PROCESS_116 :'预览这篇文档',
	DOCUMENT_PROCESS_117 :'预览这篇文档发布效果',
	DOCUMENT_PROCESS_118 :'发布这篇文档',
	DOCUMENT_PROCESS_119 :'发布这篇文档，生成这篇文档的细览页面以及更新相关概览页面',
	DOCUMENT_PROCESS_120 :'复制这篇文档到',
	DOCUMENT_PROCESS_121 :'引用这篇文档到',
	DOCUMENT_PROCESS_122 :'移动这篇文档到',
	DOCUMENT_PROCESS_123 :'删除文档',
	DOCUMENT_PROCESS_124 :'删除文档',
	DOCUMENT_PROCESS_125 :'改变这篇文档状态',
	DOCUMENT_PROCESS_126 :'设置这篇文档权限',
	DOCUMENT_PROCESS_127 :'仅发布这篇文档细览',
	DOCUMENT_PROCESS_128 :'仅发布这篇文档细览，仅重新生成这篇文档的细览页面',
	DOCUMENT_PROCESS_129 :'撤销发布这篇文档',
	DOCUMENT_PROCESS_130 : '撤销发布这篇文档，撤回已发布目录或页面',
	DOCUMENT_PROCESS_131 :'为这篇文档产生版本',
	DOCUMENT_PROCESS_132 :'管理这篇文档版本',
	DOCUMENT_PROCESS_133 :'管理这篇文档历史版本',
	DOCUMENT_PROCESS_134 :'分隔线',
	DOCUMENT_PROCESS_135 :'导出这篇文档',
	DOCUMENT_PROCESS_136 :'将这篇文档导出成zip文件',
	DOCUMENT_PROCESS_137 :'管理评论',
	DOCUMENT_PROCESS_138 :'管理文档的评论',
	DOCUMENT_PROCESS_139 :'调整顺序',
	DOCUMENT_PROCESS_140 :'预览这些文档',
	DOCUMENT_PROCESS_141 :'预览这些文档发布效果',
	DOCUMENT_PROCESS_142 :'发布这些文档',
	DOCUMENT_PROCESS_143 :'发布这些文档，生成这些文档的细览页面以及更新相关概览页面',
	DOCUMENT_PROCESS_144 :'复制这些文档到',
	DOCUMENT_PROCESS_145 :'移动这些文档到',
	DOCUMENT_PROCESS_146 :'引用这些文档到',
	DOCUMENT_PROCESS_147 :'改变这些文档的状态',
	DOCUMENT_PROCESS_148 :'设置这些文档的权限',
	DOCUMENT_PROCESS_149 :'仅发布这些文档细览',
	DOCUMENT_PROCESS_150 :'仅发布这些文档细览，仅重新生成这些文档的细览页面',
	DOCUMENT_PROCESS_151 :'撤销发布这些文档',
	DOCUMENT_PROCESS_152 :'撤销发布这些文档，撤回已发布目录或页面',
	DOCUMENT_PROCESS_153 :'为这些文档产生版本',
	DOCUMENT_PROCESS_154 :'导出这些文档',
	DOCUMENT_PROCESS_155 :'将当前文档导出成zip文件',
	DOCUMENT_PROCESS_156 : '映射文件名',
	DOCUMENT_PROCESS_157 : '映射文件名只支持字母和数字,长度为1-30.',
	DOCUMENT_PROCESS_158 : '新建',
	DOCUMENT_PROCESS_159 : '新建一篇文档',
	DOCUMENT_PROCESS_160 : '请选择要删除的文档',
	DOCUMENT_PROCESS_161 : '删除',
	DOCUMENT_PROCESS_162 : '删除这篇/些文档',
	DOCUMENT_PROCESS_163 : '请选择要预览的文档',
	DOCUMENT_PROCESS_164 : '预览这篇/些文档',
	DOCUMENT_PROCESS_165 : '请选择要发布的文档',
	DOCUMENT_PROCESS_166 : '快速发布',
	DOCUMENT_PROCESS_167 : '发布这篇/些文档',
	DOCUMENT_PROCESS_168 : '刷新',
	DOCUMENT_PROCESS_169 : '刷新列表',
	DOCUMENT_PROCESS_170 : '文档列表管理',
	DOCUMENT_PROCESS_171 : '请选择要移动的文档',
	DOCUMENT_PROCESS_172 : '请选择要复制的文档',
	DOCUMENT_PROCESS_173 : '请选择要引用的文档',
	DOCUMENT_PROCESS_174 : '移动这篇/些文档到',
	DOCUMENT_PROCESS_175 : '复制这篇/些文档到',
	DOCUMENT_PROCESS_176 : '引用这篇/些文档到',
	DOCUMENT_PROCESS_177 : '文档标题',
	DOCUMENT_PROCESS_178 : '序号',
	DOCUMENT_PROCESS_179 : '栏目名称',
	DOCUMENT_PROCESS_180 : '移除引用',
	DOCUMENT_PROCESS_181 : '排序',
	DOCUMENT_PROCESS_182 : "--当前文档--",
	DOCUMENT_PROCESS_183 : "上移",
	DOCUMENT_PROCESS_184 : "下移",
	DOCUMENT_PROCESS_185 : "预览文档",
	DOCUMENT_PROCESS_186 : "保存文档",
	DOCUMENT_PROCESS_187 : "扩展字段管理",
	DOCUMENT_PROCESS_188 : "至",
	DOCUMENT_PROCESS_189 : "文档-智能创建Office文档",
	DOCUMENT_PROCESS_190 : "无",
	DOCUMENT_PROCESS_191 : '自动保存于:',
	DOCUMENT_PROCESS_192 : '是否进入只读模式，点确定进入？',
	DOCUMENT_PROCESS_193 : "扩展字段[",
	DOCUMENT_PROCESS_194 : '文档版本保存结果',
	DOCUMENT_PROCESS_195 : '显示注释',
	DOCUMENT_PROCESS_196 : '隐藏注释',
	DOCUMENT_PROCESS_197 :"当前文档列表不支持排序",
	DOCUMENT_PROCESS_198 :"自动排序列表不支持手动排序",
	DOCUMENT_PROCESS_199 :"当前文档没有权限排序",
	DOCUMENT_PROCESS_200 :"[文档RecID-",
	DOCUMENT_PROCESS_201 :'置顶文档与非置顶文档间不能交叉排序.',
	DOCUMENT_PROCESS_202 :'您确定要调整文档的顺序？',
	DOCUMENT_PROCESS_203 : "[引用多篇文档:",
	DOCUMENT_PROCESS_204 : '链接型栏目不允许文档管理.',
	DOCUMENT_PROCESS_205 : '链接地址:',
	DOCUMENT_PROCESS_206 : '文档LOGO',
	DOCUMENT_PROCESS_207 : '计划撤销发布时间不能早于当前时间',
	DOCUMENT_PROCESS_208 : '系统提示信息',
	DOCUMENT_PROCESS_209 : '选择模板',
	DOCUMENT_PROCESS_210 : '插入广告位出错:',
	DOCUMENT_PROCESS_211 : '标题',
	DOCUMENT_PROCESS_212 : '发稿人',
	DOCUMENT_PROCESS_213 : '关键词',
	DOCUMENT_PROCESS_214 : '输入串长度超长',
	DOCUMENT_PROCESS_215 : '请输入合法的数字',
	DOCUMENT_PROCESS_216 : "您的IE插件已经将对话框拦截！\n",
	DOCUMENT_PROCESS_217 : "请将拦截去掉-->点击退出-->关闭IE，然后重新打开IE登录即可！\n",
	DOCUMENT_PROCESS_218 : "给您造成不便，TRS致以深深的歉意！",
	DOCUMENT_PROCESS_219 : '抽取失败.',
	DOCUMENT_PROCESS_220 : '正文内容不能为空.',
	DOCUMENT_PROCESS_221 : '执行导入文档..',
	DOCUMENT_PROCESS_222 : '{0}-调整顺序',
	DOCUMENT_PROCESS_223 : '没有需要导出的文档.',
	DOCUMENT_PROCESS_224 : '关闭',
	DOCUMENT_PROCESS_225 : '请选择链接栏目.',
	DOCUMENT_PROCESS_226 : '链接地址长度不能超过',
	DOCUMENT_PROCESS_227 : "没有找到指定的文档版本[ID={0}]",
	DOCUMENT_PROCESS_228 : '引用文档',
	DOCUMENT_PROCESS_229 : "确定要<font color='red' style='font-size:14px;'>复制所有</font>文档么？将<font color='red' style='font-size:14px;'>不可逆转</font>！",
	DOCUMENT_PROCESS_230 : "确定要<font color='red' style='font-size:14px;'>移动所有</font>文档么？将<font color='red' style='font-size:14px;'>不可逆转</font>！",
	DOCUMENT_PROCESS_231 : "确定要<font color='red' style='font-size:14px;'>撤销发布</font>所选文档么？将<font color='red' style='font-size:14px;'>不可逆转</font>！",
	DOCUMENT_PROCESS_232 : "取消置顶",
	DOCUMENT_PROCESS_233 : "只有一个文档将被选中.确定吗？",
	DOCUMENT_PROCESS_234 : "显示子栏目的文档",
	DOCUMENT_PROCESS_235 : "隐藏子栏目的文档",
	DOCUMENT_PROCESS_236 : "跟踪文档",
	DOCUMENT_PROCESS_237 : "提取成功！",
	DOCUMENT_PROCESS_238 : "提取失败！",
	DOCUMENT_PROCESS_239 : "直接发布这篇文档",
	DOCUMENT_PROCESS_240 : '发布这篇文档,同时发布此文档的所有引用文档',
	DOCUMENT_PROCESS_241 : '直接发布这些文档',
	DOCUMENT_PROCESS_242 : '发布这些文档，同步发布这些文档所有的引用文档',
	DOCUMENT_PROCESS_243 : '改变状态',
	DOCUMENT_PROCESS_244 : '设置权限',
	DOCUMENT_PROCESS_245 : '仅发布细览',
	DOCUMENT_PROCESS_246 : '仅发布这篇/些文档细览',
	DOCUMENT_PROCESS_247 : '直接发布',
	DOCUMENT_PROCESS_248 : '撤销发布',
	DOCUMENT_PROCESS_249 : '撤销发布这篇/些文档',
	DOCUMENT_PROCESS_250 : '产生版本',
	DOCUMENT_PROCESS_251 : '为这篇/些文档产生版本',
	DOCUMENT_PROCESS_252 : '导出文档',
	DOCUMENT_PROCESS_253 : '导出这/篇些文档',
	DOCUMENT_PROCESS_254 : '直接撤销发布这篇文档',
	DOCUMENT_PROCESS_255 : '直接撤销发布这些文档',
	DOCUMENT_PROCESS_256 : '撤回当前文档的发布页面，并同步撤销文档的所有引用以及原文档发布页面',
	DOCUMENT_PROCESS_257 : '撤回这些文档的发布页面，并同步撤销文档的所有引用以及原文档发布页面',
	DOCUMENT_PROCESS_258 : "确定要<font color='red' style='font-size:14px;'>撤销发布</font>所选文档及其所有引用文档么？将<font color='red' style='font-size:14px;'>不可逆转</font>！",
	DOCUMENT_PROCESS_259 : "直接撤销发布",
	DOCUMENT_PROCESS_260 : "定时发布时间不能早于当前时间",
	DOCUMENT_PROCESS_261 : "限时置顶时间不能早于当前时间",
	DOCUMENT_PROCESS_262 : "定时发布时间不能为空",
	DOCUMENT_PROCESS_263 : "限时置顶时间不能为空",
	DOCUMENT_PROCESS_264 : "计划撤销发布时间不能为空",
	DOCUMENT_PROCESS_265 : "简易编辑器",
	DOCUMENT_PROCESS_266 : '请选择所属的分类',
	DOCUMENT_PROCESS_267 : '修改这篇文档属性',
	DOCUMENT_PROCESS_268 : '修改这些文档属性',
	DOCUMENT_PROCESS_269 : '执行复制文档..',
	DOCUMENT_PROCESS_270 : '执行移动文档..',
	DOCUMENT_PROCESS_271 : '执行导出文档..',
	DOCUMENT_PROCESS_272 : '下一步',
	DOCUMENT_PROCESS_273 : "改变这篇文档的密级",
	DOCUMENT_PROCESS_274 : "改变文档的密级",
	DOCUMENT_PROCESS_275 : '改变这篇/些文档的密级',
	DOCUMENT_PROCESS_276 : '置顶设置'
});
/*
包含了
1.wcm\app\js\easyversion\ajax.js
2.wcm\app\js\easyversion\web2frameadapter.js
3.wcm\app\js\source\wcmlib\com.trs.web2frame\AjaxRequest.js
中的文件
*/
Ext.apply(wcm.LANG, {
	AJAX_ALERT_1 : '尚未登陆，请重新登录',
	AJAX_ALERT_2 : '与服务器交互时出现错误！',
	AJAX_ALERT_3 : '您已退出系统，请重新登录',
	AJAX_ALERT_4 : '与服务器交互失败，服务器已经停止或者您的网络出现故障！',
	AJAX_ALERT_5 : 'URL已经超出1000个字节(',
	AJAX_ALERT_6 : '), 建议使用POST提交数据！',
	AJAX_ALERT_7: '参数传入错误:_oPost不能为Function类型.',
	AJAX_ALERT_8: '参数传入错误:不存在id为',
	AJAX_ALERT_9: '的form对象.',
	AJAX_ALERT_10: '参数传入错误:_bSend只能为true,false或null.',
	AJAX_ALERT_11: '与服务器交互时出现错误！',
	AJAX_ALERT_12: '与服务器交互时发生了以下异常：\n'
});


//多语种
Ext.apply(wcm.LANG, {
	UNIT : '个',
	TEMPLATE : '模板',
	TEMPLATE_0 : '修改这个模板',
	TEMPLATE_1 : '修改当前选中的模板',
	TEMPLATE_2 : '预览这个模板',
	TEMPLATE_3 : '预览当前选中的模板',
	TEMPLATE_4 : '导出这个模板',
	TEMPLATE_5 : '导出当前选中的模板',
	TEMPLATE_6 : '校验这个模板',
	TEMPLATE_7 : '校验当前选中的模板',
	TEMPLATE_8 : '删除这个模板',
	TEMPLATE_9 : '删除当前选中的模板(不可恢复)',
	TEMPLATE_10 : '同步模板附件',
	TEMPLATE_11 : '同步当前选中模板的附件',
	TEMPLATE_12 : '新建一个模板',
	TEMPLATE_13 : '导入模板',
	TEMPLATE_14 : '从文件中导入模板到当前栏目',
	TEMPLATE_15 : '导出所有模板',
	TEMPLATE_16 : '导出当前列出的所有模板',
	TEMPLATE_17 : '校验所有模板',
	TEMPLATE_18 : '校验当前列出的所有模板',
	TEMPLATE_19 : '同步所有模板附件',
	TEMPLATE_20 : '同步当前所列模板的附件',
	TEMPLATE_21 : '删除这些模板',
	TEMPLATE_23 : '校验这些模板',
	TEMPLATE_22 : '导出这些模板',
	TEMPLATE_24 : '模板导入',
	TEMPLATE_25 : '模板校验',
	TEMPLATE_ALERT : '没有任何要操作的模板！',
	TEMPLATE_CONFIRM_0 : '此操作将校验模板的语法和文法细则，可能需要较长时间。确实要进行模板校验吗？',
	TEMPLATE_CONFIRM_1 : '此操作将重新分发模板附件，可能需要较长时间。确实要同步附件吗？',
	TEMPLATE_ALERT_0 : '请选择模板类型！',
	TEMPLATE_ALERT_1 : '请输入模板内容！',
	TEMPLATE_ALERT_2 : '请选择模板类型后再进行此操作！',
	TEMPLATE_CALLBACK : '模板名称已经存在',
	TEMPLATE_ALERT_3 : '没有找到模板正文所在的文本框！',
	TEMPLATE_INNER_0 : '隐藏TRS置标添加向导',
	TEMPLATE_INNER_1 : '进入置标编辑模式',
	TEMPLATE_INNER_2 : '显示TRS置标添加向导',
	TEMPLATE_ALL : '全部模板',
	TEMPLATE_OUTLINE : '概览模板',
	TEMPLATE_XILAN : '细览模板',
	TEMPLATE_NESTING : '嵌套模板',
	TEMPLATE_USED : '已被使用的',
	TEMPLATE_NON : '未被使用的',
	TEMPLATE_CRBYME : '我创建的',
	TEMPLATE_LASTWEEK : '最近一周',
	TEMPLATE_TEMPNAME : '模板名称',
	TEMPLATE_TEMPDESC : '模板描述',
	TEMPLATE_TEMPDESC : '模板描述',
	TEMPLATE_TEMPCRUSER : '创建者',
	TEMPLATE_TEMPID : '模板Id',
	TEMPLATE_26 : '递归显示',
	TEMPLATE_27 : '仅显示当前',
	HIDTEMP : '点击切换递归显示所有模板\n;当前为：仅显示当前',
	SHOWTEMP : '点击切换递归显示所有模板\n;当前为：递归显示',
	TEMPLATE_USED_1 : '查看模板被栏目或站点使用的情况',
	TEMPLATE_USED_2 : '查看模板被栏目或站点使用的情况',
	TEMPLATE_USED_3 : '查看模板被栏目或站点使用的情况',
	TEMPLATE_ALERT4 :'文件路径为空，上传失败！',
	TEMPLATE_RESULT : '模板导入结果',
	TEMPLATE_ALERT5:'请选择置标类型！',
	TEMPLATE_ALERT6:'已经复制到剪切板中！',
	TEMPLATE_RESULT1:'模板校验结果',
	TEMPLATE_SELECT:'选择模板',
	CLOSE:'关闭',
	TRUE:'确定',
	REFRESH : '刷新',
	CANCEL : '取消',
	TEMPLATE_29:'当前编辑的模板 - ',
	TEMPLATE_ALERT7:'设置成功！',
	TEMPLATE_ALERT8:'忽略错误',
	TEMPLATE_ALERT9:'返回修改',
	TEMPLATE_ALERT10:'返回模板编辑',
	TEMPLATE_ALERT11:'您的浏览器不支持自动复制操作，请手工拷贝！',
	EMPOLOYTO : '将模板分配给栏目或站点使用',
	TEMPLATE_28 : '当前模板并不是概览模板。<br><br>点击[确定]将按<b>默认首页模板</b>预览该{0}。',
	TEMPLATE_30 : '确实要将这{0}个模板删除吗? ',
	TEMPLATE_31:'成功同步了模板附件！实际耗时<br><b> {0}</b>s.',
	TEMPLATE_MESSAGE : '限字母，数字和下划线',
	TEMPLATE_TEXNAME : '文件扩展名',
	TEMPLATE_OUTLINENAME : '发布文件名',
	SELECT_OBJECT : '选择对象',
	TEMPLATE_32 : '新建',
	TEMPLATE_33 : '新建一个模板',
	TEMPLATE_34 : '导入',
	TEMPLATE_35 : '导出',
	TEMPLATE_36 : '导出模板',
	TEMPLATE_37 : '同步附件',
	TEMPLATE_38 : '删除',
	TEMPLATE_39 : '删除这个/些模板',
	TEMPLATE_40 : '刷新',
	TEMPLATE_41 : '刷新列表',
	TEMPLATE_42 : '模板列表管理',
	TEMPLATE_45 : '选择的模板将全部替换当前编辑器的内容，你确定要执行此操作么？',
	TEMPLATE_46 : '返回',
	TEMPLATE_47 :'选择广告',
	TEMPLATE_48 :'插入广告位出错：',
	TEMPLATE_49 : '校验模板..',
	TEMPLATE_50 : '同步模板附件..',
	TEMPLATE_51 : '粘贴模板..',
	TEMPLATE_CHNL : '栏目',
	TEMPLATE_SITE : '站点',
	TEMPLATE_52 : '没有找到指定ID[{0}]的Select！',
	TEMPLATE_53 : 'WCAG2校验',
	TEMPLATE_54 : 'WCAG2校验当前选中的模板',
	TEMPLATE_55 : '模板WCAG2校验结果',
	TEMPLATE_56 : '无障碍处理建议',
	TEMPLATE_57 : 'W3C规范',
	TEMPLATE_58 : '无障碍检查结果:符合WCAG2规范.',
	TEMPLATE_59 : '无障碍检查结果',
	TEMPLATE_60 : '警告',
	TEMPLATE_61 : '错误',
	TEMPLATE_62 : '建议',
	TEMPLATE_63 : '详细',
	TEMPLATE_64 : 'HTML格式不规范',
	TEMPLATE_65 : '页面没有指定DOCTYPE',
	TEMPLATE_66 : '在页面的开始部分指定一个标准的文档类型声明，例如：<br>',
	TEMPLATE_67 : '查看',
	TEMPLATE_68 : '全部W3C推荐的文档类型声明.',
	TEMPLATE_69 : '多语言',
	TEMPLATE_70 : 'html节点上没有指定lang/xml:lang属性或属性值为空',
	TEMPLATE_71 : '在HTML节点上添加lang属性和值，例如：<br>',
	TEMPLATE_72 : '页面的Charset属性没有指定',
	TEMPLATE_73 : '在Head节点中添加描述charset的meta节点，例如：<br>',
	TEMPLATE_74 : '标题',
	TEMPLATE_75 : '页面没有包含Title节点或者Title无内容',
	TEMPLATE_76 : '在页面Head部分添加Title节点，例如：<br>',
	TEMPLATE_77 : '&nbsp;&nbsp;&lt;TITLE&gt;描述这个页面的说明&lt;/TITLE&gt;',
	TEMPLATE_78 : '页面正文中没有和Title相对应的H1节点',
	TEMPLATE_79 : '页面正文中的H1节点数超过2个,不建议',
	TEMPLATE_80 : '页面正文中的H1节点的内容应该完全匹配或包含于页面标题（Title）的内容',
	TEMPLATE_81 : '在页面Body部分添加隐藏的H1节点与Title对应，内容保持一致，例如：<br>',
	TEMPLATE_82 : '描述这个页面的说明',
	TEMPLATE_83 : '将页面正文中的部分H1节点调整为H2-H6节点',
	TEMPLATE_84 : '调整H1节点/Title使得H1和Title的内容相等',
	TEMPLATE_85 : '标题/类目',
	TEMPLATE_86 : '不是使用H1-H6来定义页面的框架结构',
	TEMPLATE_87 : '使用页面标签将页面划分为 标题, 段落, 列表, 引用等，例如：<br>',
	TEMPLATE_88 : '&nbsp;&nbsp;使用 &lt;h1&gt; 标签来区分顶层头信息而不是简单的加大加粗这些文字，再使用CSS格式化这些标签的内容。',
	TEMPLATE_89 : '图片',
	TEMPLATE_90 : 'IMG,AREA,INPUT(type=image)的节点没有指定alt属性',
	TEMPLATE_91 : 'IMG节点的alt属性为空',
	TEMPLATE_92 : '为页面中表示内容的图片指定alt属性，例如：<br>',
	TEMPLATE_93 : '图片说明',
	TEMPLATE_94 : '<br>为页面中不用于表示内容的图片指定alt属性，设置其说明为空，例如：<br>',
	TEMPLATE_95 : '请确定当前alt属性为空的图片不用于表示内容，否则需要为其指定说明，例如：<br>',
	TEMPLATE_96 : 'B,I节点为非WCAG2的规范节点,建议替换为strong,em',
	TEMPLATE_97 : '使用strong,em节点加粗/斜字体，避免使用B,I节点，例如：<br>',
	TEMPLATE_98 : '加粗',
	TEMPLATE_99 : '加斜',
	TEMPLATE_100 : '数据表格',
	TEMPLATE_101 : '描述数据的表格中没有指定summary属性且不包含Caption节点',
	TEMPLATE_102 : 'Frame/Iframe节点没有指定title属性',
	TEMPLATE_103 : '为页面中的Iframe/Frame节点指定title属性，例如：<br>',
	TEMPLATE_104 : '页面说明',
	TEMPLATE_105 : 'Object/Applet节点中不包含内容',
	TEMPLATE_106 : '为页面中的Object/Applet节点添加内容，例如：<br>',
	TEMPLATE_107 : 'Embed节点没有指定alt属性,以及Embed节点中没有包含NoEmbed节点且下一个节点不是NoEmbed节点',
	TEMPLATE_108 : '为Embed节点指定alt属性，例如：<br>',
	TEMPLATE_109 : '表单',
	TEMPLATE_110 : 'Form表单中没有表示提交的按钮(input type=submit/image 或button type=submit)',
	TEMPLATE_111 : 'Form表单中增加表示提交的按钮，例如：<br>',
	TEMPLATE_112 : '表单控件',
	TEMPLATE_113 : '可能原因',
	TEMPLATE_114 : '1、Input(type=image)控件没有指定alt/title属性;',
	TEMPLATE_115 : '2、Input(type=button/submit/reset)控件没有指定value属性;',
	TEMPLATE_116 : '3、Input(type=text/radio/checkbox/password)/Select/Textarea控件没有指定title属性且没有相关的label节点',
	TEMPLATE_117 : '4、Button控件没有指定文本内容且没有title属性',
	TEMPLATE_118 : '1、为Input(type=image)控件指定alt属性，例如：<br>',
	TEMPLATE_119 : '<br>2、为Input(type=button/submit/reset)控件指定value属性，例如：<br>',
	TEMPLATE_120 : '<br>3、为Input(type=text/radio/checkbox/password)/Select/Textarea控件指定title属性，例如：<br>',
	TEMPLATE_121 : '<br>4、为Button控件指定文本内容，例如：<br>',
	TEMPLATE_122 : '按钮内容',
	TEMPLATE_123 : '菜单/导航条',
	TEMPLATE_124 : '每个表示菜单/导航条的OL/UL控件应该对应着一个H2-H6的标签',
	TEMPLATE_125 : '表示菜单/导航条的OL/UL控件对应增加一个H2-H6的标签，例如：<br>',
	TEMPLATE_126 : '更多下载选项',
	TEMPLATE_127 : '其他文件格式',
	TEMPLATE_128 : '旧版本',
	TEMPLATE_129 : '测试版本',
	TEMPLATE_130 : '候选发行版本',
	TEMPLATE_131 : '控件指定了onmouseover事件的行为,但是没有与之相同行为的onfocus事件相对应',
	TEMPLATE_132 : '为控件同时指定onfocus行为，并与onmouseover一致，例如：<br>',
	TEMPLATE_133 : '使用可通过键盘切换到焦点的控件替换该控件，例如：<br>',
	TEMPLATE_134 : '控件指定了onclick事件的行为,但是该控件不可选中(focus)',
	TEMPLATE_135 : '<br>转换为<br>',
	TEMPLATE_136 : '您没有选择任何模板！',
	TEMPLATE_137 : '模板正文不能为空',
	TEMPLATE_LASTMODIFIEDUSER :'最近修改人',
	TEMPLATE_138 : '当前编辑的模板 - ',
	TEMPLATE_139 : '导入模板',
	TEMPLATE_140 : '当前编辑的模板 - ',
	TEMPLATE_141 : '请输入模板名.',
	TEMPLATE_142 : '分配',
	TEMPLATE_143 : '执行模板导出..'
});
//下拉提示
Ext.ns('Event');
Ext.applyIf(Event, {
	KEY_BACKSPACE:	8,
	KEY_TAB:		9,
	KEY_RETURN:		13,
	KEY_ESC:		27,
	KEY_LEFT:		37,
	KEY_UP:			38,
	KEY_RIGHT:		39,
	KEY_DOWN:		40,
	KEY_DELETE:		46,
	KEY_PGUP:		33,
	KEY_PGDN:		34,
	KEY_HOME:		36,
	KEY_END:		35
});
Ext.ns("wcm.Suggestion");
wcm.Suggestion = function(config){
	Ext.apply(this, config || {});
};
Ext.apply(wcm.Suggestion.prototype, {
	autoComplete : true,
	requestOnFocus : true,
	init : function(config){
		if(this.inited) return;
		this.inited = true;
		config = Ext.apply({"list-min-height" : '80px', "list-max-height" : '140px'}, config);
		if(!config['el']){
			alert("the [el] parameter must be set! ");
			return;
		}
		this.inputEl = $(config['el']);
		Ext.apply(this, config);
		this.initBoxEl();
		this.initEvents();
	},
	initBoxEl : function(){
		var doc = this.inputEl.ownerDocument;
		var dom = doc.createElement("div");
		dom.style.display = 'none';
		dom.setAttribute("unselectable", "on");
		Element.addClassName(dom, "sg-box");
		doc.body.appendChild(dom);
		this.boxEl = dom;
	},
	initEvents : function(){
		this.keyUpEventBind = this.keyUpEvent.bind(this);
		this.blurEventBind = this.blurEvent.bind(this);
		Event.observe(this.inputEl, 'keyup', this.keyUpEventBind);
		Event.observe(this.inputEl, 'blur', this.blurEventBind);
		if(this.requestOnFocus){
			this.focusEventBind = this.focusEvent.bind(this);
			Event.observe(this.inputEl, 'focus', this.focusEventBind);
		}
		Event.observe(this.boxEl, 'mousemove', this.mouseMoveEvent.bind(this));
		Event.observe(this.boxEl, 'click', this.clickEvent.bind(this));
		Event.observe(this.boxEl, 'mouseover', this.mouseOverEvent.bind(this));
		Event.observe(this.boxEl, 'mouseout', this.mouseOutEvent.bind(this));
		Event.observe(this.boxEl, 'selectstart', function(){return false;});
	},
	keyUpEvent : function(event){
		event = event || window.event;
		var keyCode = event.keyCode;
		switch(keyCode){
			case Event.KEY_RETURN:
				this.keyEnter(event);
				break;
			case Event.KEY_UP:
				this.keyUp(event);
				break;
			case Event.KEY_DOWN:
				this.keyDown(event);
				break;
			default:
				this.keyCommon(event);
		}
	},
	mouseOverEvent : function(event){
		this.inBoxEl = true;
	},
	mouseOutEvent : function(event){
		this.inBoxEl = false;
	},
	blurEvent : function(event){
		if(this.inBoxEl) return;
		this.hideList();
	},
	focusEvent : function(){
		this.request(this.getInputValue());
	},
	keyCommon : function(event){
		var keyCode = event.keyCode;
		if(this.getInputValue() == "" && !this.requestOnFocus){
			this.hideList();
			return;
		}
		if(keyCode == Event.KEY_LEFT || keyCode == Event.KEY_RIGHT) return;
		this.request(this.getInputValue());
		this.showList();
	},
	request : function(){
		//TODO request for get something and the addItem to this suggestion.
	},
	keyEnter : function(){
		this.hideList();
		this.execute();
	},
	keyUp : function(){
		if(!this.boxEl || !Element.visible(this.boxEl)) return;
		var item = null;
		if(this.selectedItem){
			item = Element.previous(this.selectedItem);
			var height = this.selectedItem.offsetHeight;
			var scrollTop = this.boxEl.scrollTop;
			this.boxEl.scrollTop = scrollTop - height;
		}else{
			item = Element.last(this.boxEl);
			this.boxEl.scrollTop = this.boxEl.scrollHeight;
		}
		if(!item) return;
		this.setSelectedItem(item, true);
	},
	keyDown : function(){
		if(!this.boxEl || !Element.visible(this.boxEl)) return;
		var item = null;
		if(this.selectedItem){
			item = Element.next(this.selectedItem);
			var height = this.selectedItem.offsetHeight;
			var scrollTop = this.boxEl.scrollTop;
			this.boxEl.scrollTop = scrollTop + height;
		}else{
			item = Element.first(this.boxEl);
			this.boxEl.scrollTop = 0;
		}
		if(!item) return;
		this.setSelectedItem(item, true);
	},
	mouseMoveEvent : function(event){
		event = event || window.event;
		var element = Event.element(event);
		var item = this.findItem(element);
		if(item == this.selectedItem) return;
		this.setSelectedItem(item);
	},
	findItem : function(dom){
		while(dom && dom.tagName != "BODY"){
			if(Element.hasClassName(dom, "item")){
				return dom;
			}
			dom = dom.parentNode;
		}
		return null;
	},
	clickEvent : function(event){
		event = event || window.event;
		var element = Event.element(event);
		var item = this.findItem(element);
		if(!item) return;	
		this.setSelectedItem(item, true);
		this.hideList();
		this.execute();
	},
	showList : function(){
		//set height.
		var nodes = this.boxEl.childNodes;
		if(nodes.length < 4) this.boxEl.style.height = this["list-min-height"];
		if(nodes.length > 8) this.boxEl.style.height = this["list-max-height"];
		if(Element.visible(this.boxEl)) return;
		if(!this.initPosition){
			this.initPosition = true;
			Position.clone(this.inputEl, this.boxEl, {setHeight:false, offsetTop:this.inputEl.offsetHeight});
		}else{
			Position.clone(this.inputEl, this.boxEl, {setLeft : false, setHeight:false, offsetTop:this.inputEl.offsetHeight});
		}
		Element.show(this.boxEl);
	},
	hideList : function(){
		Element.hide(this.boxEl);
	},
	setSelectedItem : function(item, bSynInputValue){
		if(this.selectedItem) Element.removeClassName(this.selectedItem, "selected");		
		if(item) Element.addClassName(item, "selected");		
		this.selectedItem = item;
		if(bSynInputValue && this.autoComplete) this.setInputValue(this.getListValue());
	},
	getList : function(){
		return this.boxEl;
	},
	getListValue : function(item){
		item = item || this.selectedItem;
		if(!item) return this.getInputValue();
		return item.getAttribute("_value") || "";
	},
	getInput : function(){
		return this.inputEl;
	},
	getInputValue : function(){
		return this.inputEl.value;
	},
	setInputValue : function(sValue){
		this.inputEl.value = sValue;
	},
	execute : function(){
		//TODO override the method.
		//alert(this.getInputValue());
	},
	setItems : function(items){
		delete this.selectedItem;
		this.setItemsHtml(this.html(items));			
		this.fix4Ie();
	},
	setItemsHtml : function(sHtml){
		delete this.selectedItem;
		Element.update(this.boxEl, sHtml);
		this.showList();
		this.fix4Ie();
	},
	addItems : function(items){
		var sHtml = this.html(items);
		new Insertion.Bottom(this.boxEl, sHtml);
		this.showList();
		this.fix4Ie();
	},
	addItem : function(item){
		var sHtml = this.html(item);
		new Insertion.Bottom(this.boxEl, sHtml);
		this.showList();
		this.fix4Ie();
	},
	isIE : function(){
		var ua = navigator.userAgent.toLowerCase();
		var isIE = ua.indexOf("opera") == -1 && ua.indexOf("msie") > -1;
		return isIE;
	}(),
	fix4Ie : function(){
		return; //be afraid of performance.
		if(!this.isIE) return;
		var doms = this.boxEl.getElementsByTagName("*");
		for (var i = 0; i < doms.length; i++){
			doms.setAttribute("unselectable", "on");
		}
	},
	html : function(item){
		item = Ext.Json.toUpperCase(item);
		if(Array.isArray(item)){
			var aHtml = [];
			for (var i = 0; i < item.length; i++){
				aHtml.push(this.html(item[i]));
			}
			return aHtml.join("");
		}
		var sValue = (""+item["VALUE"]).replace(/\'/g,"&#39;");
		var sLable = (""+item["LABEL"]).replace(/\'/g,"&#39;");
		return [
			"<div unselectable='on' class='item' _value='", sValue, "'>", sLable, "</div>" 
		].join("");
	},
	destroy : function(){
		delete this.inited;
		Event.stopObserving(this.inputEl, 'keyup', this.keyUpEventBind);
		delete this.keyUpEventBind;
		Event.stopObserving(this.inputEl, 'blur', this.blurEventBind);
		delete this.blurEventBind;
		if(this.requestOnFocus){
			Event.stopObserving(this.inputEl, 'focus', this.focusEventBind);
			delete this.focusEventBind;
		}
		delete this.inputEl;
		if(this.boxEl1){
			Event.stopObserving(this.boxEl);
			Element.remove(this.boxEl);
		}
		delete this.boxEl;
		delete this.inBoxEl;
	}
});
if(!window.wcm) wcm = {};
if(!wcm.LANG) wcm.LANG = {};
WCMLANG = wcm.LANG;
if(!wcm.apply)wcm.apply = function(o, c){if(o && c){for(var p in c){o[p] = c[p];}}return o;}
wcm.apply(wcm.LANG, {
	WCM52_ALERT_1 : '传入无效的对象类型',
	WCM52_ALERT_2 : '传入无效的对象',
	WCM52_ALERT_3 : '传入无效的对象名称',
	WCM52_ALERT_4 : '无效的Operator对象！',
	WCM52_ALERT_5 : '顶级窗口必须定义函数[removeId]以维持数据同步！',
	WCM52_ALERT_6 : '对象已存在！',
	WCM52_ALERT_7 : '顶级窗口必须定义函数[addId]以维持数据同步！',
	WCM52_ALERT_8 : '数据有误：',
	WCM52_ALERT_9 : '点击后可以选择一列',
	WCM52_ALERT_10 : '删除',
	WCM52_ALERT_11 : '删除当前设置信息',
	WCM52_ALERT_12 : '您确认删除全部的设置！',
	WCM52_ALERT_13 : '不正确！溢出！',
	WCM52_ALERT_14 : '帮助',
	WCM52_ALERT_15 : '没有找到必须的源文件',
	WCM52_ALERT_16 : '客户端校验器组装失败！ 无法找到目标元素！\n',
	WCM52_ALERT_17 : '请输入',
	WCM52_ALERT_18 : '执行批量操作时，一次性提交的数量不能超过200！',
	WCM52_ALERT_19 : '设定颜色',
	WCM52_ALERT_20 : '您的IE插件已经将对话框拦截！\n',
	WCM52_ALERT_21 : '请将拦截去掉-->点击退出-->关闭IE，然后重新打开IE登录即可！\n',
	WCM52_ALERT_22 : '给您造成不便，TRS致以歉意！',
	WCM52_ALERT_23 : '系统已经关闭！请退出！',
	WCM52_ALERT_24 : '秒',
	WCM52_ALERT_25 : '系统正在运行中,请耐心等待.....',
	WCM52_ALERT_26 : '欢迎您使用TRS WCM系统',
	WCM52_ALERT_27 : '等待时间',
	WCM52_ALERT_28 : '调用错误',
	WCM52_ALERT_29 : '没有定义INPUT',
	WCM52_ALERT_30 : '您输入的',
	WCM52_ALERT_31 : '不是一个小数！',
	WCM52_ALERT_32 : '您输入的',
	WCM52_ALERT_33 : '不是一个整数！',
	WCM52_ALERT_34 : '不能超过最大长度',
	WCM52_ALERT_35 : '不能小于最小值',
	WCM52_ALERT_36 : '设定了错误的最大长度值！',
	WCM52_ALERT_37 : '设定了错误的最大值！',
	WCM52_ALERT_38 : '设定了错误的最小值！',
	WCM52_ALERT_39 : '不是闰年！',
	WCM52_ALERT_40 : '对不起，您输入的信息为空！',
	WCM52_ALERT_41 : '对不起，您指定了无效的日期格式！',
	WCM52_ALERT_42 : '您设定的日期格式有误！不支持这种日期格式！',
	WCM52_ALERT_43 : ' 或是 ',
	WCM52_ALERT_44 : '[年] 必须大于 1949！',
	WCM52_ALERT_45 : '[月] 必须在 1-12 之间！',
	WCM52_ALERT_46 : '[日] 必须在 1-31 之间！',
	WCM52_ALERT_47 : '闰年的二月最多只有29天！',
	WCM52_ALERT_48 : '闰年的二月有 1到29 天！',
	WCM52_ALERT_49 : '当前月份最多只有30天！',
	WCM52_ALERT_50 : '[时] 必须在 1-24 之间！',
	WCM52_ALERT_51 : '[分] 必须在 1-60 之间！',
	WCM52_ALERT_52 : '您输入的日期',
	WCM52_ALERT_53 : '不匹配合法的日期格式！ \n 一个正确的日期格式应当为：',
	WCM52_ALERT_54 : '指定的根节点',
	WCM52_ALERT_55 : '不存在！',
	WCM52_ALERT_56 : '指定的父节点',
	WCM52_ALERT_57 : '长度大于最大长度',
	WCM52_ALERT_58 : '注：每个汉字长度为2)！',
	WCM52_ALERT_59 : '您输入的密码长度大于最大长度',
	WCM52_ALERT_60 : '长度小于最小长度',
	WCM52_ALERT_61 : '您输入的密码长度小于最小长度',
	WCM52_ALERT_62 : '无效Email地址！',
	WCM52_ALERT_63 : '字符串',
	WCM52_ALERT_64 : '属于数据库关键字，不能使用！',
	WCM52_ALERT_65 : '字符串',
	WCM52_ALERT_66 : '包含禁用的特殊字符',
	WCM52_ALERT_67 : "[{0}]为空，此字段为必填！",
	WCM52_ALERT_68 : "[{0}]大于最大值 [{1}]！",
	WCM52_ALERT_69 : "[{0}]小于最小值 [{1}]！",
	WCM52_ALERT_70 : "[{0}]长度大于最大长度 [{1}](注：每个汉字长度为2)！",
	WCM52_ALERT_71 : "[{0}]长度小于最小长度 [{1}](注：每个汉字长度为2)！",
	WCM52_ALERT_72 : "[{0}]不符合Email格式，如xxx@xxx.com！",
	WCM52_ALERT_73 : "[{0}]不符合URL格式，如http://www.trs.com.cn！",
	WCM52_ALERT_74 : "[{0}]不符合ip格式，如192.9.200.22！",
	WCM52_ALERT_75 : "[{0}]不符合格式，必须为字母、下划线或者数字所组成，首字母需为字母！",
	WCM52_ALERT_76 : "[{0}]不符合格式，必须为字母、下划线或者数字所组成！",
	WCM52_ALERT_77 : "[{0}]中含有数据库关键字，不合法！",
	WCM52_ALERT_78 : '{0}不能为空',
	WCM52_ALERT_79 : '{0}必须为数字',
	WCM52_ALERT_80 : '{0}必须为整数',
	WCM52_ALERT_81 : '{0}必须为整数',
	WCM52_ALERT_82 : '{0}必须为小数',
	WCM52_ALERT_83 : '{0}必须为双精度数',
	WCM52_ALERT_84 : '{0}最小长度为{1}',
	WCM52_ALERT_85 : '{0}最大长度为{1}',
	WCM52_ALERT_86 : '{0}最小值为{1}',
	WCM52_ALERT_87 : '{0}最大值为{1}',
	WCM52_ALERT_88 : '{0}长度范围为{1}~{2}',
	WCM52_ALERT_89 : '{0}值范围为{1}~{2}',
	WCM52_ALERT_90 : '{0}期望格式为:http(s)://[站点](:[端口])/(子目录)',
	WCM52_ALERT_91 : '{0}期望格式为:xxx.xxx.xxx',
	WCM52_ALERT_92 : '{0}IPV4格式，期望格式为: 192.9.200.114',
	WCM52_ALERT_93 : '{0}必须为字母、下划线或者数字所组成',
	WCM52_ALERT_94 : '{0}必须为Email格式(如xxx@xxx.com)',
	WCM52_ALERT_95 : '格式不正确，需匹配正则式：{0}',	
	WCM52_ALERT_96 : "[{0}]不是整型数!",
	WCM52_ALERT_97 : "[{0}]不是浮点数!",
	WCM52_ALERT_98 : "[{0}]小数位数超过[18]!",
	WCM52_ALERT_99 : "[{0}]小数位数超过[{1}]!",
	WCM52_USER : '用户',
	WCM52_GROUP : '用户组',
	WCM52_ROLE : '角色',
	WCM52_UNKNOWN : '未知',
	WCM52_SELECTALL : '全选',
	WCM52_NO : '序号',
	WCM52_TYPE : '类型',
	WCM52_NAME : '名称'
});
var  ValidatorLang =
{
LOCALE		:	'cn',
TEXT1		:	'时间的time_format格式不对',
TEXT2		:	'没有指定field域',
TEXT3		:	'没有指定sub_type域',
TEXT4		:	'域指定不合法',
TEXT5		:	'不应包含\\/:*?\"<>|等字符',
TEXT6		:	'普通字符，\\/:*?\"<>|等字符除外',
TEXT7		:	"没有匹配日期格式:",
TEXT8		:	"小时应该是0到23的整数",
TEXT9		:	"分应该是0到59的整数",
TEXT10		:	"秒应该是0到59的整数",
TEXT11		:	"指定的",
TEXT12		:	"不是分割的两个数字！",
TEXT13		:	"不是个数字！",
TEXT14		:	"月份应该为1到12的整数",
TEXT15		:	"每个月的天数应该为1到31的整数",
TEXT16		:	"该月不存在31号",
TEXT17		:	"2月最多有29天",
TEXT18		:	"闰年2月才有29天",
TEXT19		:	"小时应该是0到23的整数",
TEXT20		:	"分应该是0到59的整数",
TEXT21		:	"秒应该是0到59的整数",
TEXT22		:	"日期格式错误：",
TEXT23		:	'{0}不能为空.',
TEXT24		:	'{0}必须和{1}一致.',
TEXT25		:	'{0}必须为数字.',
TEXT26		:	'{0}必须为整数.',
TEXT27		:	'{0}必须为小数.',
TEXT28		:	'{0}必须为双精度.',
TEXT29		:	'{0}最小长度为{1}.',
TEXT30		:	'{0}最大长度为{1}.',
TEXT31		:	'{0}最小值为 {1}.',
TEXT32		:	'{0}最大值为{1}.',
TEXT33		:	'{0}长度范围为{1}~{2}.',
TEXT34		:	'{0}值范围为{1}~{2}.',
TEXT35		:	'{0}期望格式为:http(s)://[站点](:[端口])/(子目录).',
TEXT36		:	'{0}期望格式为:xxx.xxx.xxx.xxx..',
TEXT37		:	'{0}符合IPV4格式，期望格式为: 192.9.200.114.',
TEXT38		:	'{0}由字母,数字,下划线组成.',
TEXT39		:	'{0}由字母开始的字母,数字,下划线组成.',
TEXT40		:	'必须选择一个{0}',
TEXT41		:	'{0}格式必须为\"hh:mm\"，如：09:03',
TEXT42		:	'{0}格式必须为\"h:m\"，如：9:3' ,
TEXT43		:	'{0}格式不合法.',
TEXT44		:	'{0}小于最小长度{1}.',
TEXT45		:	'{0}大于最大长度{1}.',
TEXT46		:	'{0}小于最小值({1}).',
TEXT47		:	'{0}大于最大值({1}).',
TEXT48		:	'{0}长度超出范围{1}~{2}.',
TEXT49		:	'{0}值超出范围{1}~{2}.',
TEXT50		:	'{0}正确格式为：http(s)://[站点](:[端口])/(子目录).',
TEXT51		:	'{0}不合法,正确格式为:xxx.xxx.xxx.xxx..',
TEXT52		:	'{0}不符合IPV4格式！正确格式为: 192.9.200.114.',
TEXT53		:	'{0}IPV4最高位不能为0！正确格式为: 192.9.200.114.',
TEXT54		:	'{0}IPV4任一位数值不能超过255！正确格式为: 192.9.200.114.',
TEXT55		:	'{0}不是由字母、数字、下划线组成.',
TEXT56		:	'{0}不是由字母开始的字母,数字,下划线组成.',
TEXT57		:	'小时必须在0~23之间',
TEXT58		:	'分钟必须在0~59之间',
TEXT59		:	'秒必须在0~59之间',
TEXT60		:	'{0}由中文或字母开头的字符串组成.',
TEXT61		:	'{0}不是由中文或字母开头的字符串组成.'
}
//中文
/** Title:			TRSWindow.js
 *  Description:
 *		Define CTRSHashtable Object
 *  Copyright: 		www.trs.com.cn
 *  Company: 		TRS Info. Ltd.
 *  Author:			CH
 *  Created:		2004-11-23 15:27
 *  Vesion:			1.0
 *  Last EditTime:	2004-11-23/2004-11-23
 *	Update Logs:
 *		CH@2004-11-23 Created File
 *	Note:
 *		
 *
 */
function TRSItem(_oValue, _nIndex){
	this.value = _oValue;
	this.index = _nIndex;
}

function CTRSHashtable() {
	this.oObjects	= null;
	this.arKeys		= null;
	this.length		= 0;

	this.init		= function(){
		this.oObjects	= {};
		this.arKeys		= [];
	}

	this.clear		= function(){
		this.oObjects	= null;
		this.arKeys		= null;
	}

	this.contains	= function(_oValue){
		return (typeof(this.oObjects[_oValue]) != "undefined");
	}

	this.containsKey= function(_oKey){
		CTRSAction_alert("Not Realize!");
		return false;
	}

	this.get		= function(_oKey){
		var oTRSItem = this.oObjects[_oKey];
		if(oTRSItem == null 
			|| typeof(oTRSItem) != "object" 
			|| oTRSItem.constructor != TRSItem){
			return null;
		}

		return oTRSItem.value;
	}

	this.keys		= function(){
		var arTemp = [];
		for(var i=0; i<this.arKeys.length; i++){
			if(this.arKeys[i] == null)continue;
			
			arTemp[arTemp.length] = this.arKeys[i];
		}
		return arTemp;
	}

	this.isEmpty	= function(){
		return this.size() == 0;
	}

	this.put		= function(_oKey, _oValue){
		//1. Check Param		
		if(_oKey == null || _oValue == null){
			CTRSAction_alert("Param not Valid["+typeof(_oKey)+"["+typeof(_oValue)+"]");
			return false;
		}

		//2.init
		if(this.oObjects == null)
			this.init();

		//3. Put in 
		var oTRSItem = this.oObjects[_oKey];
		if(oTRSItem == null 
			|| typeof(oTRSItem) != "object" 
			|| oTRSItem.constructor != TRSItem){			
			oTRSItem = new TRSItem(_oValue, this.arKeys.length);
			this.arKeys[this.arKeys.length] = _oKey;
			this.oObjects[_oKey] = oTRSItem;
			this.length++;
		}else{
			oTRSItem.value = _oValue;
		}
		
		
		//4.Return Result
		return true;
	}

	this.putAll		= function(_oTRSHashtable){
		var nSize = _oTRSHashtable.size();
		var arKeys = _oTRSHashtable.keys();
		for(var i=0; i<nSize; i++){
			this.put(arKeys[i], _oTRSHashtable.get(arKeys[i]));			
		}		
	}

	this.remove		= function(_oKey){
		var oTRSItem = this.oObjects[_oKey];
		if(oTRSItem == null 
			|| typeof(oTRSItem) != "object" 
			|| oTRSItem.constructor != TRSItem)
			return null;

		var oValue = oTRSItem.value;
		this.arKeys[oTRSItem.index] = null;
		this.oObjects[_oKey]		= null;
		this.length--;
		return oValue;
	}

	this.size		= function(){
		return this.length;
	}
	
}
/** Title:			CTRSRequestParam.js
 *  Description:
 *		Define TRSRequestParam Object
 *  Copyright: 		www.trs.com.cn
 *  Company: 		TRS Info. Ltd.
 *  Author:			CH
 *  Created:		2004-11-24 08:38
 *  Vesion:			1.0
 *  Last EditTime:	2004-11-24/2004-11-24
 *	Update Logs:
 *		CH@2004-11-24 Created File
 *	Note:
 *		
 *	Depends:
 *		CTRSHashtable.js
 *
 *	Examples:
 *			
 */

function CTRSRequestParam(){
	this.hParameters = null;

	this.init				= function(){
		if(this.hParameters != null)return;

		try{
			this.hParameters = new CTRSHashtable();				
		}catch(e){
			CTRSAction_alert("Please include CTRSHashtable.js!");
		}		
	}
	
	this.setParameter		= function(_sParameterName, _sValue){
		this.init();
		return this.hParameters.put(_sParameterName, _sValue);
	}

	this.removeParameter	= function(_sParameterName){
		if(this.hParameters == null)
			return null;

		return this.hParameters.remove(_sParameterName);
	}	

	this.toURLParameters	= function(){
		var sURLParam = "trandom="+Math.random();

		if(this.hParameters == null || this.hParameters.size()<=0)
			return sURLParam;

		var nSize = this.hParameters.size();
		var arKeys = this.hParameters.keys();
		for(var i=0; i<nSize; i++){
			var sParamName = arKeys[i];
			if(sParamName == 'trandom') continue;
			var sValue = this.hParameters.get(sParamName);
			try{var arIds = sValue.split(",");}catch(e){}
			if(arIds && arIds.length && arIds.length > 200){
				CTRSAction_alert(wcm.LANG.WCM52_ALERT_18 || "执行批量操作时，一次性提交的数量不能超过200！");
				return null;
			}
			if(sValue.length < 500){
				sValue = encodeURIComponent(sValue);
			}
			sURLParam += "&"+sParamName+"="+sValue;
		}		
		return sURLParam;
	}

	this.setAllParameters	= function(_oTRSRequestParam){
		if(_oTRSRequestParam.hParameters == null || _oTRSRequestParam.hParameters.size()<=0)
			return;
		//初始化
		this.init();
		//复制
		this.hParameters.putAll(_oTRSRequestParam.hParameters);
	}
	
}

var TRSRequestParam = new CTRSRequestParam();
/** 
 * @fileoverview 
 * 此文件定义了CTRSAction对象，完成WEB应用常用的交互方式（例如：Link/OpenWin/Dialog/XMLHTTP...）<BR>
 *  Copyright: 		www.trs.com.cn<BR>
 *  Company: 		TRS Info. Ltd.<BR>
 *  Author:			CH<BR>
 *  Created:		2004-11-24 08:38<BR>
 *  Vesion:			1.0<BR>
 *  Last EditTime:	2004-11-24/2004-11-24<BR>
 *	Update Logs:<BR>
 *		CH@2004-11-24 Created File<BR>
 *	Note:<BR>
 *		<BR>
 *	Depends:<BR>
 *		CTRSReqeustParam.js<BR>
 *		CTRSHashtable.js<BR>
 *<BR>
 *	Examples:<BR>
 *		@see CTRSAction_test.html<BR>
 * @author CH cao.hui@trs.com.cn
 * @version 1.o
 */

 /**
 * TRSAction构造函数
 * @class CTRSAction类
 * @constructor
 * @param {int} _sActionURL 交互的地址
 * @return CTRSAction的一个实例
 */

var RE_REPLACE2PATHSEP = new RegExp('([^:])\/{2,}','ig');

function CTRSAction(_sActionURL){
//Define Properties
	try{
		/**
		 * @private
		 */
		this.oActionParam = new CTRSRequestParam();
	}catch(e){
		alert("Not include file CTRSRequestParam.js!");
		return;
	}	

	/**
	 * 设置给交互页面传递的参数
	 * @param {String} 参数名称
	 * @param {String} 参数值
	 */
	this.setParameter = function(_sParameterName, _sValue){
		return this.oActionParam.setParameter(_sParameterName, _sValue);
	}

	//If Self Action
	if(CTRSAction_isSelfLocation(_sActionURL)){
		/**
		 * @private
		 */	
		this.sActionURL = CTRSAction_getLocationURL();
		this.oActionParam.setAllParameters(TRSRequestParam);		
	}else{
		/**
		 * @private
		 */
		this.sActionURL = _sActionURL;
	}

//Define Methods
	this.getActionURL		= CTRSAction_getActionURL;
	this.validateActionURL	= CTRSAction_validateActionURL;
	this.doAction			= CTRSAction_doAction;
	this.doDialogAction		= CTRSAction_doDialogAction;
	this.doModelessDialogAction = CTRSAction_doModelessDialogAction;
	this.doOpenWinAction	= CTRSAction_doOpenWinAction;
	this.doOpenWinActionX	= CTRSAction_doOpenWinActionX;
	this.doXMLHttpAction	= CTRSAction_doXMLHttpAction;
	this.getRemoteData		= CTRSAction_doXMLHttpAction;
	this.inheritParameters	= CTRSAction_inheritParameters;
	this.doNoScrollDialogAction	= CTRSAction_doNoScrollDialogAction;
}


/**
 * 发出交互请求
 * @requirs CTRSAction CTRSAcation的实例
 */
function CTRSAction_doAction(){
	if(!this.validateActionURL()) return;

	try{
		if(RunningProcessBar){
			RunningProcessBar.start();
		}
	}catch(e){}

	window.location.href = this.getActionURL();
}	

/**
 * 结合设置的交互参数,获取交互地址
 */
function CTRSAction_getActionURL(){
	var sURL		= this.sActionURL;
	var nStartPose  = sURL.indexOf("?");
	if(nStartPose >= 0)
		sURL += "&";
	else
		sURL += "?";
	sURL = sURL.replace(RE_REPLACE2PATHSEP,'$1/');
	return sURL + this.oActionParam.toURLParameters();
}

function CTRSAction_validateActionURL(){
	return (this.oActionParam.toURLParameters() != null);
}

function CTRSAction_isSelfLocation(_sURL){
	if(_sURL == null)return true;

	var sSelfURL		= window.location.href;
	var nStartPose		= sSelfURL.indexOf("?");
	if(nStartPose >= 0)
		sSelfURL = sSelfURL.substring(0, nStartPose);
	
	nStartPose		= sSelfURL.lastIndexOf("/");
	if(nStartPose >= 0)
		sSelfURL = sSelfURL.substring(nStartPose+1);
	
	return (sSelfURL == _sURL.replace(RE_REPLACE2PATHSEP,'$1/'));
}


/**
 * 获取当前页面的链接地址
 */
function CTRSAction_getLocationURL(){
	var sURL		= window.location.href.replace(RE_REPLACE2PATHSEP,'$1/');
	var nStartPose  = sURL.indexOf("?");
	if(nStartPose >= 0)
		sURL = sURL.substring(0, nStartPose);
	sURL = sURL.replace(RE_REPLACE2PATHSEP,'$1/');

	return sURL;
}

/**
 * 发出带有滚动条对话框交互的请求
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 * @param {object} _oArgs 传入对话框的参数（可以为int string array htmlelement；其它自定义对象不行）
 * @throws 如果浏览器设置了拦截，会弹出解除拦截提示
 * @return {object} 返回值
 */
function CTRSAction_doDialogAction(_nWidth, _nHeight, _oArgs, _nTop, _nLeft){
	//1.verify parameters
	if(!this.validateActionURL()) return;

	var nWidth	= _nWidth	|| 200;
	var nHeight = _nHeight	|| 200;

	var nLeft	= _nLeft || (window.screen.availWidth - nWidth)/2;
	var nTop	= _nTop || (window.screen.availHeight - nHeight)/2;

	//2.Construct parameters for dialog
	var sFeatures		= "dialogHeight: "+nHeight+"px; dialogWidth: "+nWidth+"px; "
						+ "dialogTop: "+nTop+"; dialogLeft: "+nLeft+"; "
						+ "center: Yes; scroll:Yes;help: No; resizable: No; status: No;";
	//3.display Dialog
	var sDialogUrl = TRSAction_ROOT_PATH + "/include/dialog_window.html";
    sDialogUrl = sDialogUrl.replace(RE_REPLACE2PATHSEP,'$1/');
	var sURL = this.getActionURL();
	var arArgs = new Array();
	arArgs[0] = sURL;
	arArgs[1] = window.location.href.replace(RE_REPLACE2PATHSEP,'$1/');
	arArgs[2] = _oArgs;
	arArgs[3] = window;
	try{
		if(window.showModalDialog!=null){
			var sResult = window.showModalDialog(sDialogUrl, arArgs, sFeatures);
			return sResult;
		}else{
			window.open(sURL, null,"top="+nTop+",left="+nLeft+",fullscreen =no,menubar =no,toolbar =no,width="+nWidth+",height="+nHeight+",scrollbars=yes,location =no,titlebar=no,modal=yes",false);
		}
	}catch(e){
		alert("您的IE插件已经将对话框拦截！\n"
				+ "请将拦截去掉-->点击退出-->关闭IE，然后重新打开IE登录即可！\n"
				+ "给您造成不便，TRS致以歉意！");
		return true;
	}
	
}

/**
 * 发出带有滚动条非模态对话框交互的请求
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 * @param {object} _oArgs 传入对话框的参数（可以为int string array htmlelement；其它自定义对象不行）
 * @throws 如果浏览器设置了拦截，会弹出解除拦截提示
 * @return {object} 返回值
 */
function CTRSAction_doModelessDialogAction(_nWidth, _nHeight, _oArgs, _nTop, _nLeft){
	//1.verify parameters
	if(!this.validateActionURL()) return;

	var nWidth	= _nWidth	|| 200;
	var nHeight = _nHeight	|| 200;

	var nLeft	= _nLeft || (window.screen.availWidth - nWidth)/2;
	var nTop	= _nTop || (window.screen.availHeight - nHeight)/2;

	//2.Construct parameters for dialog
	var sFeatures		= "dialogHeight: "+nHeight+"px; dialogWidth: "+nWidth+"px; "
						+ "dialogTop: "+nTop+"; dialogLeft: "+nLeft+"; "
						+ "center: Yes; scroll:Yes;help: No; resizable: No; status: No;";
	//3.display Dialog
	var sDialogUrl = TRSAction_ROOT_PATH + "/include/dialog_window.html";
	sDialogUrl = sDialogUrl.replace(RE_REPLACE2PATHSEP,'$1/');
	var sURL = this.getActionURL();
	var arArgs = new Array();
	arArgs[0] = sURL;
	arArgs[1] = window.location.href.replace(RE_REPLACE2PATHSEP,'$1/');
	arArgs[2] = _oArgs;
	try{
		if(window.showModelessDialog != null){
			var sResult = window.showModelessDialog(sDialogUrl, arArgs, sFeatures);	
			return sResult;
		}else{
			window.open(sURL, null,"top="+nTop+",left="+nLeft+",fullscreen =no,menubar =no,toolbar =no,width="+nWidth+",height="+nHeight+",scrollbars=no,location =no,titlebar=no,modal=yes",false);
		}
	}catch(e){
		alert("您的IE插件已经将对话框拦截！\n"
				+ "请将拦截去掉-->点击退出-->关闭IE，然后重新打开IE登录即可！\n"
				+ "给您造成不便，TRS致以歉意！");
		return true;
	}
	
}

/**@private*/
var m_oXMLHttpTemp = null;

var INTERVAL_CHECK_XMLHTTP_STATE = 1000;

/**@private*/
function CTRSAction_checkXMLHttpStatus(){
	if(m_oXMLHttpTemp == null || m_oXMLHttpTemp.readyState == 4){
		if(RunningProcessBar){
			RunningProcessBar.close();
		}
		if(m_oXMLHttpTemp.status != 200){
			switch(m_oXMLHttpTemp.status){
				case 401:
					//CTRSAction_alert("您登录超时，请重新登录！");
					window.top.location.href = "../include/not_login.htm";
					return null;
				default:
					CTRSAction_displyInfo(600, 600, m_oXMLHttpTemp.responseText);
					return null;
			}
		}
		m_oXMLHttpTemp = null;
		return;
	}

	setTimeout("CTRSAction_checkXMLHttpStatus();", INTERVAL_CHECK_XMLHTTP_STATE);
}

/**
 * 发出XMLHttp请求
 * @param {string} _sPostData 传送的数据
 * @param {boolean} _bAsync 是否为非同步方式
 * @param {boolean} _bStartingProcessBar 非同步方式的时候是否显示进度条
 */
function CTRSAction_doXMLHttpAction(_sPostData, _bAsync, _bStartingProcessBar){
	//1.verify parameters
	if(!this.validateActionURL()) return;

	var bAsync = false;
	if(_bAsync)bAsync = true;
	
	var oXMLHttp = null;
	if(window.ActiveXObject){
		oXMLHttp = new ActiveXObject("Microsoft.XMLHTTP"); //建立XMLHTTP对象
	}else if(window.XMLHttpRequest){  //for ff , or other????
		oXMLHttp = new XMLHttpRequest();
	}
	
	if(_bStartingProcessBar){
		if(!RunningProcessBar){
			//CTRSAction_alert("Pleas include [../js/CRunningProcessBar.js]");
			return;
		}
		//RunningProcessBar.start();

		try{
			oXMLHttp.open("POST", this.getActionURL(), bAsync);		
			oXMLHttp.send(_sPostData);
		}catch(e){
			if(e == "[object Error]"){
				alert("系统已经关闭！请退出！");
				window.top.window.close();
				return null;
			}
		}
		m_oXMLHttpTemp = oXMLHttp;
		setTimeout("CTRSAction_checkXMLHttpStatus();", INTERVAL_CHECK_XMLHTTP_STATE);
		return;
	}
	oXMLHttp.open("POST", this.getActionURL(), bAsync);
	
	try{
		oXMLHttp.send(_sPostData);
		if(oXMLHttp.status != 200){
			switch(oXMLHttp.status){
				case 401:
					//alert("您登录超时，请重新登录！");
					//CTRSAction_displyInfo(600, 600, oXMLHttp.responseText);
					window.top.location.href = "../include/not_login.htm";
					return null;
				default:
					CTRSAction_displyInfo(600, 600, oXMLHttp.responseText);
					return null;
			}
		}
	}catch(e){
		if(e == "[object Error]"){
			alert("系统已经关闭！请退出！");
			window.top.window.close();
			return null;
		}
	}

	delete oXMLHttp;
	return oXMLHttp.responseText;	
}

/**
 * 发出弹出窗口的交互请求
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 */
function CTRSAction_doOpenWinActionX(_sName, _bReplaced, _nWidth, _nHeight){
	if(!this.validateActionURL()) return;

	var nWidth	= _nWidth || (window.screen.availWidth  - 20);
	var nHeight = _nHeight || (window.screen.availHeight - 40);
	var nLeft	=(window.screen.availWidth - nWidth-10)/2;
	var nTop	= (window.screen.availHeight - nHeight-20)/2;
	var sName	= _sName || "";

	var oWin = window.open(this.getActionURL(), sName, "top="+nTop+",left="+nLeft+",fullscreen =true,menubar =no,toolbar =no,width="+nWidth+",height="+nHeight+",scrollbars=yes,location =no,titlebar=no", _bReplaced);
	if(oWin == null){
		alert("您的IE插件已经将窗口拦截！\n"
				+ "请将拦截去掉-->点击退出-->关闭IE，然后重新打开IE登录即可！\n"
				+ "给您造成不便，TRS致以歉意！");
		window.close();
	}else{
		oWin.opener =  window;
		oWin.focus();
	}
	//window.showModalDialog('../include/open_win.jsp', args,'dialogWidth:1px;dialogHeight:1px;dialogTop:1;dialogLeft:1;');
}

function CTRSAction_doOpenWinAction(_nWidth, _nHeight){
	this.doOpenWinActionX("", false, _nWidth, _nHeight);
}

/**
 * 发出不带滚动条对话框交互的请求
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 * @param {object} _oArgs 传入对话框的参数（可以为int string array htmlelement；其它自定义对象不行）
 * @throws 如果浏览器设置了拦截，会弹出解除拦截提示
 * @return {object} 返回值
 */
function CTRSAction_doNoScrollDialogAction(_nWidth, _nHeight, _oArgs){
	//1.verify parameters
	if(!this.validateActionURL()) return;

	var nWidth	= _nWidth	|| 200;
	var nHeight = _nHeight	|| 200;

	var nLeft	= (window.screen.availWidth - nWidth)/2;
	var nTop	= (window.screen.availHeight - nHeight)/2;


	//2.Construct parameters for dialog
	var sFeatures		= "dialogHeight: "+nHeight+"px; dialogWidth: "+nWidth+"px; "
						+ "dialogTop: "+nTop+"; dialogLeft: "+nLeft+"; "
						+ "center: Yes; scroll:No;help: No; resizable: No; status: No;";
	//3.display Dialog
	var sDialogUrl = TRSAction_ROOT_PATH + "/include/dialog_window.html";
	 sDialogUrl = sDialogUrl.replace(RE_REPLACE2PATHSEP,'$1/');
	var sURL = this.getActionURL();
	var arArgs = new Array();
	arArgs[0] = sURL;
	arArgs[1] = window.location.href.replace(RE_REPLACE2PATHSEP,'$1/');
	arArgs[2] = _oArgs;
	try{
		if(window.showModalDialog!=null){
			var sResult = window.showModalDialog(sDialogUrl, arArgs, sFeatures);
			return sResult;
		}else{
			window.open(sURL, null,"top="+nTop+",left="+nLeft+",fullscreen =no,menubar =no,toolbar =no,width="+nWidth+",height="+nHeight+",scrollbars=no,location =no,titlebar=no,modal=yes",false);
		}
	}catch(e){
		alert("您的IE插件已经将对话框拦截！\n"
				+ "请将拦截去掉-->点击退出-->关闭IE，然后重新打开IE登录即可！\n"
				+ "给您造成不便，TRS致以歉意！");
		return true;
	}
	
}


/**@private*/
function CTRSAction_inheritParameters(){
	this.oActionParam.setAllParameters(TRSRequestParam);
}

//Self Action 1----refreshMe
/**
 * 刷新当前的页面
 */
function CTRSAction_refreshMe(){
	var oTRSAction = new CTRSAction();
	oTRSAction.doAction();
}

//Self Action 2----gotoPage
/**
 * 在列表页面中定位到指定分页
 * @param {int} _nPageIndex 页面序号，从1开始
 */
function CTRSAction_gotoPage(pageIndexOrEl, event, _nPageCount){
	var _nPageIndex;
	if(!(typeof(pageIndexOrEl) == 'number')){
		event = event || window.event;
		switch(event.type){
			case 'blur':
				_nPageIndex = parseInt(pageIndexOrEl.value);
				if(isNaN(_nPageIndex)){pageIndexOrEl.value=''; return;}
				break;
			case 'keydown':
				if(event.keyCode==13){
					pageIndexOrEl.blur();
					return;
				}
//				Event.stop(event);
				return;
				break;
				
		}
		
	}
	else _nPageIndex = pageIndexOrEl;
	_nPageIndex = _nPageIndex > _nPageCount ? _nPageCount:_nPageIndex;
	var oTRSAction = new CTRSAction();
	oTRSAction.setParameter("PageIndex", _nPageIndex);
	oTRSAction.doAction();	
}


//Self Action 3----doSearch
/**
 * 按照Form中的数据对当前页面进行检索，一般应用在列表页面
 * @param {Form} _oForm 检索数据的Form对象
 */
function CTRSAction_doSearch(_oForm){
	var oForm = _oForm;
	if(_oForm == null)
		oForm = document.frmSearch;	

	var oTRSAction = new CTRSAction();

	var arEls = oForm.elements;//get All data from the form
	for(var i = 0;i<arEls.length;i++){			
		var sType = arEls[i].type;
		if(sType != null ){
			sType = sType.toUpperCase();
			if(sType == "BUTTON" || sType == "SUBMIT" || sType=="IMG" || sType=="RESET"){
				continue;
			}
		}

		var sValue = arEls[i].value;
		/*if(sValue.length && sValue.length > 200){
			CTRSAction_displyReports(300, 200,  "对不起，您输入的检索内容过长，超出最大长度[200]，请重新输入！");
			return;
		}
		*/

		oTRSAction.setParameter(arEls[i].name, sValue);
	}	
	//oTRSAction.setParameter("SearchKey", oForm.SearchKey.value);
	//oTRSAction.setParameter("SearchValue", oForm.SearchValue.value);
	oTRSAction.setParameter("PageIndex", 1);
	
	oTRSAction.doAction();
}

//Self Action 4----doOrderBy
/**
 * 按照指定的方式对页面进行排序，应用在列表页面中
 * @param {String} _sOrderField 排序字段
 * @param {String} _sOrderType 排序方式(DESC|ASC)
 */
function CTRSAction_doOrderBy(_sOrderField, _sOrderType){
	var oTRSAction = new CTRSAction();
	
	oTRSAction.setParameter("OrderField", _sOrderField);
	oTRSAction.setParameter("OrderType", _sOrderType);
	
	oTRSAction.setParameter("PageIndex", 1);
	
	oTRSAction.doAction();
}

/**
 * 根据指定的HTML代码显示信息提示页面
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 * @param {String} _sInforHTML 信息提示页面的内容
 */
function CTRSAction_displyInfo(_nWidth, _nHeight, _sInforHTML){
	var sURL = TRSAction_ROOT_PATH + "/include/info.html";
     sURL = sURL.replace(RE_REPLACE2PATHSEP,'$1/');
	var oTRSAction = new CTRSAction(sURL);	
	var oArgs = new Object();
	oArgs.InfoHTML = _sInforHTML;
	oTRSAction.doDialogAction(_nWidth, _nHeight, oArgs);
}

/**
 * 根据指定的HTML代码显示警告信息提示页面
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 * @param {String} _sInforHTML 信息提示页面的内容
 */
function CTRSAction_displyReports(_nWidth, _nHeight, _sInforHTML, _bInfo){
	var sURL = TRSAction_ROOT_PATH + "include/reports.html";
    sURL = sURL.replace(RE_REPLACE2PATHSEP,'$1/');
	var oTRSAction = new CTRSAction(sURL);	
	var oArgs = new Object();
	oArgs.InfoHTML = _sInforHTML;
	oArgs.IsInfo = _bInfo;
	oTRSAction.doNoScrollDialogAction(_nWidth, _nHeight, oArgs);
}

/**
 * 根据指定的HTML代码显示警告信息提示页面 confirm
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 * @param {String} _sInforHTML 信息提示页面的内容
 */
function CTRSAction_confirmReports(_nWidth, _nHeight, _sInforHTML, _bInfo){
	var sURL = TRSAction_ROOT_PATH + "include/reports_confirm.html";
	sURL = sURL.replace(/\/+/,'\/');
	var oTRSAction = new CTRSAction(sURL);	
	var oArgs = new Object();
	oArgs.InfoHTML = _sInforHTML;
	oArgs.IsInfo = _bInfo;
	var result = oTRSAction.doNoScrollDialogAction(_nWidth, _nHeight, oArgs);
	return result;
}

/**
 * 根据指定的HTML代码显示警告信息提示页面 confirm
 * @param {int} _nWidth 对话框宽度
 * @param {int} _nHeight 对话框高度
 * @param {String} _sInforHTML 信息提示页面的内容
 */
function CTRSAction_ifReports(_nWidth, _nHeight, _sInforHTML, _bInfo){
	var sURL = TRSAction_ROOT_PATH + "include/reports_if.html";
	sURL = sURL.replace(RE_REPLACE2PATHSEP,'$1/');
	var oTRSAction = new CTRSAction(sURL);	
	var oArgs = new Object();
	oArgs.InfoHTML = _sInforHTML;
	oArgs.IsInfo = _bInfo;
	var result = oTRSAction.doNoScrollDialogAction(_nWidth, _nHeight, oArgs);
	return result;
}

function CTRSAction_convertErrorInfo(_sErrorInfo){
	var MAX_LENGTH = 17;

	var nCarrigeCount	= 2;
	var nMaxLength		= MAX_LENGTH;
	var nNextPos		= _sErrorInfo.indexOf("\n");
	var nPrePos			= 0;
	while(nNextPos>=0){
		if((nNextPos-nPrePos)>nMaxLength){
			nMaxLength = (nNextPos-nPrePos);
		}
		nPrePos		= nNextPos;
		nNextPos	= _sErrorInfo.indexOf("\n", nNextPos+1);
		nCarrigeCount++;
	}	
	if((_sErrorInfo.length-nPrePos) > nMaxLength){
		nMaxLength = _sErrorInfo.length;
	}
	

	var nWidth = 300;
	if(nMaxLength>MAX_LENGTH){
		nWidth += (nMaxLength-MAX_LENGTH)*3;
	}
	var nHeight = 200;
	nHeight += 20*nCarrigeCount;

	var oInfo = new Object();
	oInfo.CarrigeCount	= nCarrigeCount;
	oInfo.MaxLength		= nMaxLength;
	oInfo.Width			= nWidth;
	oInfo.Height		= nHeight;
	oInfo.InfoHTML		= _sErrorInfo.replace(/\n/g, "<BR>");

	return oInfo;
}

function CTRSAction_alert(_sInforHTML, _bInfo){
	var oInfo = CTRSAction_convertErrorInfo(_sInforHTML);
	CTRSAction_displyReports(oInfo.Width, oInfo.Height, oInfo.InfoHTML, _bInfo);
}

function CTRSAction_confirm(_sInforHTML){
	var oInfo = CTRSAction_convertErrorInfo(_sInforHTML);
	var result = CTRSAction_confirmReports(oInfo.Width, oInfo.Height, oInfo.InfoHTML);
	return result;
}

function CTRSAction_if(_sInforHTML){
	var oInfo = CTRSAction_convertErrorInfo(_sInforHTML);
	var result = CTRSAction_ifReports(oInfo.Width, oInfo.Height, oInfo.InfoHTML);
	return result;
}


function CTRSAction_setRootPath(_sRootPath){
	this.TRSAction_ROOT_PATH = _sRootPath;
}


function CTRSAction_validateURL(_sURL,_sContent){
	var oXMLHttp = null;
	if(window.ActiveXObject){
		oXMLHttp = new ActiveXObject("Microsoft.XMLHTTP"); //建立XMLHTTP对象
	}else if(window.XMLHttpRequest){  //for ff , or other????
		oXMLHttp = new XMLHttpRequest();
	}	
	var sContent=_sContent||"";
	var bResult = false;
	try{
		oXMLHttp.open("get", _sURL.replace(RE_REPLACE2PATHSEP,'$1/'), false);
		oXMLHttp.send();
		bResult = (oXMLHttp.status != 404);
		if(sContent!=""){
			bResult = bResult&&(oXMLHttp.responseText == sContent );
		}
	}catch(e){		
		//alert(e);
	}
	
	delete oXMLHttp;
	return bResult;	
}


var TRSAction_ROOT_PATH = "../";
//文档CMSObj对象
Ext.ns('wcm.Documents', 'wcm.Document', 'wcm.ChnlDoc', 'wcm.ChnlDocs');
wcm.Documents = function(_config, _context){
	this.objType = WCMConstants.OBJ_TYPE_DOCUMENT;
	wcm.Documents.superclass.constructor.call(this, _config, _context);
}
Ext.extend(wcm.Documents, wcm.CMSObjs, {
	getDocIds : function(){
		return this.getIds();
	}
});
wcm.Document = function(_config, _context){
	this.objType = WCMConstants.OBJ_TYPE_DOCUMENT;
	wcm.Document.superclass.constructor.call(this, _config, _context);
	var arrRights ={
		"view":30,
		"new":31,
		"edit":32,
		"trash":33,
		"detail":34,
		"preview":38,
		"publish":39
	};
	for(rightName in arrRights){
		var cameRightName = rightName.camelize();
		var nRightIndex = parseInt(arrRights[rightName], 10);
		this['can'+cameRightName] = function(nRightIndex){
			return wcm.AuthServer.hasRight(this.right, nRightIndex);
		}.bind(this, nRightIndex);
	}
	this.addEvents(['preview', 'afterpreview', 'publish', 'afterpublish']);
}
CMSObj.register(WCMConstants.OBJ_TYPE_DOCUMENT, 'wcm.Document');
Ext.extend(wcm.Document, wcm.CMSObj, {
	getDocId : function(){
		return this.getId();
	},
	getRecId : function(){
		return 0;
	},
	getDocIds : function(){
		return [this.getDocId()];
	},
	getRelIds : function(){
		return [this.getRecId()];
	},
	getChannelId : function(){
		return this.getPropertyAsInt('DocChannel', 0);
	}
});
wcm.ChnlDocs = function(_config, _context){
	this.objType = WCMConstants.OBJ_TYPE_CHNLDOC;
	wcm.ChnlDocs.superclass.constructor.call(this, _config, _context);
}
Ext.extend(wcm.ChnlDocs, wcm.CMSObjs, {
	getDocIds : function(){
		var rstIds = [];
		for(var i=0,n=this.m_objs.length;i<n;i++){
			rstIds.push(this.m_objs[i].getDocId());
		}
		return rstIds;
	},
	getRelIds : function(){
		return this.getIds();
	}
});

wcm.ChnlDoc = function(_config, _context){
	this.objType = WCMConstants.OBJ_TYPE_CHNLDOC;
	wcm.ChnlDoc.superclass.constructor.call(this, _config, _context);
}
CMSObj.register(WCMConstants.OBJ_TYPE_CHNLDOC, 'wcm.ChnlDoc');
Ext.extend(wcm.ChnlDoc, wcm.Document, {
	getDocId : function(){
		return this.getPropertyAsInt("DocId", 0);
	},
	getRecId : function(){
		return this.getId();
	},
	getCurrChannelId : function(){
		return this.getPropertyAsInt('ChnlId', 0);
	}
});
Ext.ns('com.trs.FloatPanel');
(function(){
	var m_sFloatPanelId = 'floatpanel', actualTop = $MsgCenter.getActualTop();
	var m_sCurrPath = location.href.replace(new RegExp("^.*:\/\/[^\/]*((.*\/|))[^\/]+$", "ig"), "$1");
	if(actualTop.FloatPanel){
		window.FloatPanel = com.trs.FloatPanel = actualTop.FloatPanel;
		try{
			try{
				//当前引用的页面正被FloatPanel打开时不能释放
				if(FloatPanel.opened && FloatPanel._window==parent)return;
			}catch(err){
			}
			if(FloatPanel.opened)return;
			//释放内存驻留
			FloatPanel._window = null;
			if(FloatPanel.opened){
				var oPanel = FloatPanel.getPanel();
				Element.hide(oPanel);
				oPanel.src = WCMConstants.WCM6_PATH + 
					'js/source/wcmlib/com.trs.floatpanel/resource/window.html';
			}
			FloatPanel.opened = false;
		}catch(err){
		}
		return;
	}
	function calRelativePath(src){
		while(src.indexOf('./')!=-1){
			src = src.replace(/\/(\.\/)+/g, '/').replace(/\/[^\.\/]+\/\.\.\//g, '/');
		}
		src = src.replace(/(\/){2,}/g, '/');
		return src;
	}
	window.FloatPanel = com.trs.FloatPanel = {
		getPanel : function(){
			return $(m_sFloatPanelId);
		},
		hide : function(){
			var ePanel = this.getPanel();
			Element.hide(ePanel);
			$MsgCenter.enableKeyDown();
			try{
				var el = actualTop.window.$('fix-focus-element');
				if(el) el.focus();
				else actualTop.window.focus();
			}catch(err){
			}
		},
		openByInfo : function(info){
			if(!Ext.isString(info.src))return;
			this.open(info.src, info.title, info.callback, info.dialogArguments);
		},
		topMe : function(){
			$(m_sFloatPanelId).style.zIndex = $MsgCenter.genId(10000);
		},
		open : function(_src, _sTitle, _iWidth, _iHeight, _fWhenClose, _args){
			this.opened = true;
			if(!Ext.isString(_src)){
				this.openByInfo(_src);
				return;
			}
			if(!_src.startsWith('/')){
				var alink = document.createElement('A');
				_src = calRelativePath(m_sCurrPath + _src);
			}
			$MsgCenter.cancelKeyDown();
			var ePanel = this.getPanel();
			this._window = ePanel.contentWindow;
			ePanel.style.display = '';
			if(Ext.isFunction(arguments[2]) || arguments[2]==null){
				this._window.openMe(_src, _sTitle, 0, 0, arguments[2], arguments[3]);
			}else{
				this._window.openMe(_src, _sTitle, _iWidth, _iHeight, _fWhenClose, _args);
			}
			this.topMe();
			ePanel.style.width = getWidth() + 'px';
			ePanel.style.height = getHeight() + 'px';
		},
		openIn : function(_src,_sTitle,_iWidth,_iHeight,_fWhenClose){
			$MsgCenter.cancelKeyDown();
			var ePanel = this.getPanel();
			ePanel.style.display = '';
			if(Ext.isFunction(arguments[2])){
				this._window.openMe(_src, _sTitle, 0, 0, arguments[2]);
			}else{
				this._window.openMe(_src, _sTitle, _iWidth, _iHeight,_fWhenClose);
			}
			this.topMe();
		},
		close : function(){
			$MsgCenter.enableKeyDown();
			this._window.closeMe();
			this._window = null;
			$MsgCenter.getActualTop().window.focus();
		}
	}
	if(actualTop==window){
		Event.observe(window, 'load', function(){
			var pb = $(m_sFloatPanelId), os;
			if(pb)return;
			pb = document.createElement('IFRAME');
			pb.id = m_sFloatPanelId;
			pb.frameBorder = 0;
			pb.src = WCMConstants.WCM6_PATH + 
				'js/source/wcmlib/com.trs.floatpanel/resource/window.html';
			os = pb.style;
			os.position = 'absolute';
			os.left = '0px';
			os.top = '0px';
			os.width = '100%';
			os.height = '100%';
			os.display = 'none';
			pb.allowTransparency = true;
			document.body.appendChild(pb);
		});
	}
	if(actualTop.FloatPanel)return;
	for(var name in FloatPanel){
		FloatPanel[name] = function(){
			var actualTop = $MsgCenter.getActualTop();
			return actualTop.FloatPanel[this].apply(actualTop.FloatPanel, arguments);
		}.bind(name);
	}
})();
//计算当前页面的实际高度
function getHeight(){
	var yScroll;
	if (window.innerHeight && window.scrollMaxY) {
		yScroll = window.innerHeight + window.scrollMaxY;
	} else if (document.body.scrollHeight > document.body.offsetHeight){ // all but Explorer Mac
		yScroll = document.body.scrollHeight;
	} else { // Explorer Mac...would also work in Explorer 6 Strict, Mozilla and Safari
		yScroll = document.body.offsetHeight;
	}
	
	var windowHeight;
	if (self.innerHeight) { // IE
		windowHeight = self.innerHeight;
	} else if (document.documentElement && document.documentElement.clientHeight) { 	// Strict Mode
	   windowHeight = document.documentElement.clientHeight;
	} else if (document.body) { // others
	   windowHeight = document.body.clientHeight;
	}

	if(yScroll < windowHeight){
		pageHeight = windowHeight;
	} else {
		pageHeight = yScroll;
	}
	  return pageHeight;
}
function getWidth(){
	var xScroll
	if (window.innerHeight && window.scrollMaxY) {
	xScroll = document.body.scrollWidth;
	} else if (document.body.scrollHeight > document.body.offsetHeight){ // all but Explorer Mac
	xScroll = document.body.scrollWidth;
	} else {
	xScroll = document.body.offsetWidth;
	}

	var windowWidth
	if (self.innerHeight) { // IE
	windowWidth = self.innerWidth;
	} else if (document.documentElement && document.documentElement.clientHeight) { // Strict
	windowWidth = document.documentElement.clientWidth;
	} else if (document.body) { // others
	windowWidth = document.body.clientWidth;
	}

	if(xScroll < windowWidth){
	pageWidth = windowWidth;
	} else {
	pageWidth = xScroll;
	}
  return pageWidth;
}
Ext.ns('com.trs.suggestion');

Ext.applyIf(Position, {
  // set to true if needed, warning: firefox performance problems
  // NOT neeeded for page scrolling, only if draggable contained in
  // scrollable elements
  includeScrollOffsets: false,

  // must be called before calling withinIncludingScrolloffset, every time the
  // page is scrolled
  prepare: function() {
    this.deltaX =  window.pageXOffset
                || document.documentElement.scrollLeft
                || document.body.scrollLeft
                || 0;
    this.deltaY =  window.pageYOffset
                || document.documentElement.scrollTop
                || document.body.scrollTop
                || 0;
  },

  cumulativeOffset: function(element) {
    var valueT = 0, valueL = 0;
    do {
      valueT += element.offsetTop  || 0;
      valueL += element.offsetLeft || 0;
      element = element.offsetParent;
    } while (element);
    return [valueL, valueT];
  },

  // caches x/y coordinate pair to use with overlap
  within: function(element, x, y) {
    if (this.includeScrollOffsets)
      return this.withinIncludingScrolloffsets(element, x, y);
    this.xcomp = x;
    this.ycomp = y;
    this.offset = this.cumulativeOffset(element);

    return (y >= this.offset[1] &&
            y <  this.offset[1] + element.offsetHeight &&
            x >= this.offset[0] &&
            x <  this.offset[0] + element.offsetWidth);
  },

  withinIncludingScrolloffsets: function(element, x, y) {
    var offsetcache = this.realOffset(element);

    this.xcomp = x + offsetcache[0] - this.deltaX;
    this.ycomp = y + offsetcache[1] - this.deltaY;
    this.offset = this.cumulativeOffset(element);

    return (this.ycomp >= this.offset[1] &&
            this.ycomp <  this.offset[1] + element.offsetHeight &&
            this.xcomp >= this.offset[0] &&
            this.xcomp <  this.offset[0] + element.offsetWidth);
  }
});

Ext.applyIf(Event, {
  pointerX: function(event) {
    return event.pageX || (event.clientX +
      (document.documentElement.scrollLeft || document.body.scrollLeft));
  },

  pointerY: function(event) {
    return event.pageY || (event.clientY +
      (document.documentElement.scrollTop || document.body.scrollTop));
  }
});

com.trs.suggestion.Suggestion = Class.create();

com.trs.suggestion.Suggestion.SUGGESTION_PREFIX = "COM_TRS_SUGGESTION_";
com.trs.suggestion.Suggestion.SUGGESTION_COUNT = 0;

com.trs.suggestion.Suggestion.prototype = {
	initialize : function(_sAttachElement){
		this.oRelatedElement = $(_sAttachElement);

		if(this.oRelatedElement == null){
			alert(String.format('没有找到指定的元素[{0}]！' , _sAttachElement));
			return null;
		}

		this.oPreElement = null;
		this.m_nCurrentItemIndex = -1;

		var divId = com.trs.suggestion.Suggestion.SUGGESTION_PREFIX + (com.trs.suggestion.Suggestion.SUGGESTION_COUNT);
		var frameId = com.trs.suggestion.Suggestion.SUGGESTION_PREFIX + (com.trs.suggestion.Suggestion.SUGGESTION_COUNT) + "_IFRAME";
		new Insertion.After(this.oRelatedElement, '<iframe src="about:blank" frameborder="0" id="' + frameId + '" class="Suggestion2" style="display:none;"></iframe>' + '<div id="' + divId + '" class="Suggestion" style="display:none;"></div>');
		this.oSuggestionRegionElement = $(divId);
		this.oSuggestionRegionShieldElement = $(frameId);

		Position.clone(this.oRelatedElement,this.oSuggestionRegionElement, {setHeight:false,offsetTop:this.oRelatedElement.offsetHeight});

		this.oSuggestionRegionShieldElement.style.left	= this.oSuggestionRegionElement.style.left;
		this.oSuggestionRegionShieldElement.style.width	= this.oSuggestionRegionElement.style.width;
		this.oSuggestionRegionShieldElement.style.top	= this.oSuggestionRegionElement.style.top;			
		
		this.onInputMouseDown.bindFn = this.onInputMouseDown.bind(this);
		this.onInputKeyDown.bindFn = this.onInputKeyDown.bind(this);
		this.onInputKeyUp.bindFn = this.onInputKeyUp.bind(this);
		this.onInputFocus.bindFn = this.onInputFocus.bind(this);
		this.onInputClick.bindFn = this.onInputClick.bind(this);
		this.onInputBlur.bindFn = this.onInputBlur.bind(this);
		this.onItemsBlur.bindFn = this.onItemsBlur.bind(this);
		Event.observe(this.oRelatedElement, 'mousedown',this.onInputMouseDown.bindFn, false);
		Event.observe(this.oRelatedElement, 'keydown',	this.onInputKeyDown.bindFn, false);
		Event.observe(this.oRelatedElement, 'keyup',	this.onInputKeyUp.bindFn, false);
		Event.observe(this.oRelatedElement, 'focus',	this.onInputFocus.bindFn, false);
		Event.observe(this.oRelatedElement, 'click',	this.onInputClick.bindFn, false);
		Event.observe(this.oRelatedElement, 'blur',		this.onInputBlur.bindFn, false);
		
		Event.observe(this.oSuggestionRegionElement, 'blur',	this.onItemsBlur.bindFn, false);

		com.trs.suggestion.Suggestion.SUGGESTION_COUNT++;
	},

	onKeyDeal : function(nKeyCode, _event){
		this.oSuggestionRegionElement.style.display = '';
		this.oSuggestionRegionShieldElement.style.display = "";	

		if(!(nKeyCode == Event.KEY_DOWN || nKeyCode == Event.KEY_UP || nKeyCode == Event.KEY_RETURN)){
			if(this.doOnCommonKey(nKeyCode)){//返回true表示要请求刷新，false表示不请求刷新
				this.m_nCurrentItemIndex = -1;
				this.oPreElement = null;				
			}
			return true;
		}

		if(!this.oSuggestionRegionElement.hasChildNodes()){
			if(this.dealWithOnKeyReturn)
				this.dealWithOnKeyReturn();
			return true;;
		}

		var nChildrenSize = this.oSuggestionRegionElement.childNodes.length;
		var keyType = '';
		switch(nKeyCode){
			case Event.KEY_DOWN:
				/*
				this.m_nCurrentItemIndex++;
				if( this.m_nCurrentItemIndex >= nChildrenSize){
					this.m_nCurrentItemIndex = 0;
				}
				*/
				this.getNextValidItem();
				keyType = "KeyDown";
				break;
			case Event.KEY_UP:
				/*
				this.m_nCurrentItemIndex--;	
				if( this.m_nCurrentItemIndex<0 ){
					this.m_nCurrentItemIndex = nChildrenSize-1;
				}
				*/
				this.getPreviousValidItem();
				keyType = "KeyUp";
				break;
			case Event.KEY_RETURN:
				keyType = "KeyReturn";
				break;
			default:
				break;
		}

		if(this.oPreElement != null){
			Element.removeClassName(this.oPreElement, "Suggestion_MouseOver");
			Element.addClassName(this.oPreElement, "Suggestion_MouseOut");
		}

		var oSrcElement = this.oSuggestionRegionElement.childNodes[this.m_nCurrentItemIndex];

		var fun = eval("this.dealWithOn" + keyType);
		if(fun){//对于按下某个功能键的额外处理
			fun(oSrcElement);
		}
		if(keyType == 'KeyReturn'){
			//this.oSuggestionRegionElement.style.display = 'none';
			//this.oSuggestionRegionShieldElement.style.display = "none";		
			//this.oRelatedElement.focus();
		}
		if(oSrcElement == null){
			return true;
		}
		Element.removeClassName(oSrcElement, "Suggestion_MouseOut");
		Element.addClassName(oSrcElement, "Suggestion_MouseOver");

		this.oPreElement = oSrcElement;
		var json = AttributeHelper.getAttribute(this.oPreElement,"_oJson");
		AttributeHelper.setAttribute(this.oRelatedElement,"json", json);
		if(json && this._onOptionClick(_event, json)){
			this.oRelatedElement.value = this.oPreElement.innerText;
		}else if(json == null){
			this.oRelatedElement.value = this.oPreElement.innerText;
		}
		var nScrollTopOffset = this.m_nCurrentItemIndex - 1;
		if(nScrollTopOffset < 0) nScrollTopOffset = 0;
		this.oSuggestionRegionElement.scrollTop = nScrollTopOffset * 15;
		return true;		
	},

	onInputKeyDown : function(_event){
		var event = _event || window.event;
		var nKeyCode = event.keyCode;
		setTimeout(function(){
			//var eventObj = document.createEventObject();  for ff
			if(document.createEventObject){
				var eventObj = document.createEventObject();
			}else{
				var eventObj = Object.clone(_event);
			}
			eventObj.keyCode = nKeyCode;
			eventObj.type = 'keyup';
			this.onKeyDeal(nKeyCode, eventObj);
			if(this.oSuggestionRegionElement.hasChildNodes() && (nKeyCode == Event.KEY_DOWN || nKeyCode == Event.KEY_UP)){
				if(!this.exitTimeout){
					setTimeout(arguments.callee, 200);
				}
			}
		}.bind(this), 10);
	},

	onInputKeyUp : function(_event){
		this.exitTimeout = true;
	},
	
	onInputBlur : function(_event){
		var event = window.event || _event;
		if(!Position.within(this.oSuggestionRegionElement, Event.pointerX(event), Event.pointerY(event))){
			this.oSuggestionRegionElement.style.display = '';
			this.oSuggestionRegionShieldElement.style.display = "none";	
			return;
		}		
	},
	onInputFocus : function(_event){	
		this.oSuggestionRegionElement.style.display = "none";
		this.oSuggestionRegionShieldElement.style.display = "";	
	},
	onInputMouseDown : function(){
		this.synPosition();
	},
	synPosition : function(){
		Position.clone(this.oRelatedElement,this.oSuggestionRegionElement, {setWidth:false,setHeight:false,offsetTop:this.oRelatedElement.offsetHeight});
		this.oSuggestionRegionShieldElement.style.left	= this.oSuggestionRegionElement.style.left;
		this.oSuggestionRegionShieldElement.style.width	= this.oSuggestionRegionElement.style.width;
		this.oSuggestionRegionShieldElement.style.top	= this.oSuggestionRegionElement.style.top;			
	},

	onInputClick : function(_event){	
		this.onInputFocus(_event);
	},

	doOnCommonKey : function(nKeyCode){
		this.clearAllItems();
		this._sendRequest();	
		return true; //表示是否请求刷新
	},

	clearAllItems : function(){
		this.oPreElement = null;
		this.m_nCurrentItemIndex = -1;
		while(this.oSuggestionRegionElement.childNodes.length > 0){
			this.oSuggestionRegionElement.removeChild(this.oSuggestionRegionElement.childNodes[0]);
		}
	},
	
	_sendRequest : function(){
		this.sendRequest();
	},

	sendRequest : function(){
		var url = this.oRelatedElement.getAttribute("_url");
		if(url == undefined){
			alert(wcm.LANG.suggestion_1089 || "必须实现sendRequest方法或者指定合法的_url属性！");
			return;
		}
		var params = this.oRelatedElement.getAttribute("_params");
		if(params == undefined){//没有定义参数，则用控件名和控件值作为参数
			params = encodeURIComponent(this.oRelatedElement.name + "=" + this.oRelatedElement.value);
		}else{//用指定的参数作为QueryString,如：_params = "userName=$F('userName')&password=$F('password')"
			var tempParams = params.toQueryParams();
			for(prop in tempParams){
				tempParams[prop] = eval(tempParams[prop]);
			}
			params = $H(tempParams).toQueryString();
		}
		var ajax = new Ajax.Request(url, {
			method		: 'get',
			parameters	: params,
			onComplete	: this._onComplete.bind(this),
			onFailure	: this.onFailure.bind(this)
		});	
	},

	_onComplete : function(originalRequest){
		this.onComplete(originalRequest);
	},

	/*必须实现onComplete方法或者ajax请求返回的xml格式为
	 *	<items><item>...</item>...</items>
	 *  其中的item用的是控件的_item属性，没有指定的话，则用item字符串
	*/
	onComplete : function(originalRequest){
		var subTagName = this.oRelatedElement.getAttribute("_item") || "item";
		var xmlDoc = originalRequest.responseXML;	
		var items = xmlDoc.getElementsByTagName(subTagName);
		if(!items || !items.length){
			return;
		}
		for(var count = 0; count < items.length; count++){
			var itemValue = items[count].firstChild.nodeValue;
			this.addItem(itemValue);
		}
	},

	onFailure : function(originalRequest){
		alert('Ajax request failure');
	},

	//添加多项，这些项的内容由_fWorker(_arrJson[...])得到
	addOptions : function(_arrJson,_fWorker){
		_arrJson.each(function(e){this.addItem(e, _fWorker)}.bind(this));
	},

	//添加一项，这项的内容由_fWorker(_oJson)得到
	addOption : function(_oJson, _fWorker){
		var sHtml = _oJson;
		if(_fWorker){
			sHtml = _fWorker(_oJson);
		}
		if(typeof sHtml == 'string'){
			this.addItem(sHtml, _oJson);
		}else{
			//this.addItem(sHtml);
			//TODO
		}	
	},

	//添加一项，这项的内容为_sItemHTML
	addItem : function(_sItemHTML, _oJson){
		var div = document.createElement("div");
		div.innerHTML = _sItemHTML;
		
		this.oSuggestionRegionElement.appendChild(div);
		if(this.oSuggestionRegionElement.childNodes.length > 10){
			this.oSuggestionRegionElement.style.overflow  = "auto";
		}
		
		div.setAttribute("_index", "" + (this.oSuggestionRegionElement.childNodes.length - 1) + "");
		if(_oJson){
			AttributeHelper.setAttribute(div,"_oJson", _oJson);
		}

		Element.addClassName(div, "Suggestion_MouseItem");
		Element.addClassName(div, "Suggestion_MouseOut");
		
		Event.observe(div, 'mouseover', this.onItemMouseOver.bind(this, div), false);
		Event.observe(div, 'click',	this.onItemClick.bind(this, div), false);	
	},

	onItemMouseOver : function(srcElement, _event){
		if(this.oPreElement){
			Element.removeClassName(this.oPreElement, "Suggestion_MouseOver");
			Element.addClassName(this.oPreElement, "Suggestion_MouseOut");
		}
		Element.removeClassName(srcElement, "Suggestion_MouseOut");
		Element.addClassName(srcElement, "Suggestion_MouseOver");
		this.oPreElement = srcElement;
		this.m_nCurrentItemIndex = parseInt(srcElement.getAttribute("_index"));
	},

	_onOptionClick : function(_event, _oJson){//单击某下拉项时的处理
		if(this.onOptionClick){
			return this.onOptionClick(_event, _oJson);
		}
		return Prototype.K(true);
	},

	onItemClick : function(srcElement, _event){
		var event = window.event || _event;
		if(this._onOptionClick(event, AttributeHelper.getAttribute(srcElement,"_oJson"))){
			this.oRelatedElement.value = this.oPreElement.innerText;
		}
		this.oSuggestionRegionElement.style.display = 'none';
		this.oSuggestionRegionShieldElement.style.display = "none";	
	},
	getCurrSelect : function(){
		return this.oPreElement;
	},
	onItemsBlur : function(_event){	
		var event = window.event || _event;
		if(!Position.within(this.oSuggestionRegionElement, Event.pointerX(event), Event.pointerY(event))){
			this.oSuggestionRegionElement.style.display = 'none';
			this.oSuggestionRegionShieldElement.style.display = "none";	
		}
	},
	hideNotMatch : function(){//隐藏所有不匹配的项
		var matchValue = this.oRelatedElement.value;
		var childs = this.oSuggestionRegionElement.childNodes;
		for (var i = 0; i < childs.length; i++){
			var child = childs[i];
			if(child.innerText.indexOf(matchValue) >= 0){
				child.style.display = '';
			}else{
				child.style.display = 'none';
			}
		}
	},
	isValid : function(element){//判断项element是否有效
		try{
			return Element.visible(element);
		}catch(error){
			alert(element.nodeType);
		}
	},
	getNextValidItem : function(){//得到有效的下一项
		var childs = this.oSuggestionRegionElement.childNodes;
		var childSize = childs.length;
		if(childSize == 0)return;
		var oldIndex = this.m_nCurrentItemIndex; //可能为-1
		var index = (oldIndex+1) % childSize;
		while(index != oldIndex){
			if(this.isValid(childs[index])){
				break;
			}
			index = (++index) % childSize;
			if(index == 0 && oldIndex == -1){
				index = -1;
				break;
			}
		}
		this.m_nCurrentItemIndex = index;
	},
	getPreviousValidItem : function(){//得到有效的前一项
		var childs = this.oSuggestionRegionElement.childNodes;
		var childSize = childs.length;
		if(childSize == 0)return;
		var oldIndex = this.m_nCurrentItemIndex;
		var index = (oldIndex <= 0) ? (childSize-1) : (oldIndex-1) % childSize;
		while(index != oldIndex){
			if(this.isValid(childs[index])){
				break;
			}
			index = (--index) % childSize;
			if(index < 0){
				index = childSize-1;
			}
			if(index == (childSize-1) && oldIndex == -1){
				index = -1;
				break;
			}
		}
		this.m_nCurrentItemIndex = index;		
	},
	destroy : function(){
		Event.stopObserving(this.oRelatedElement, 'mousedown',this.onInputMouseDown.bindFn, false);
		Event.stopObserving(this.oRelatedElement, 'keydown',	this.onInputKeyDown.bindFn, false);
		Event.stopObserving(this.oRelatedElement, 'keyup',	this.onInputKeyUp.bindFn, false);
		Event.stopObserving(this.oRelatedElement, 'focus',	this.onInputFocus.bindFn, false);
		Event.stopObserving(this.oRelatedElement, 'click',	this.onInputClick.bindFn, false);
		Event.stopObserving(this.oRelatedElement, 'blur',		this.onInputBlur.bindFn, false);		
		Event.stopObserving(this.oSuggestionRegionElement, 'blur',	this.onItemsBlur.bindFn, false);
	}
}

var AttributeHelper = {
	prefix : 'attr_',
	autoId : 0,
	cache : {},
	setAttribute : function(element, sAttrName, sAttrValue){
		element = $(element);
		if(!element) return false;
		var _id = this.getId(element);
		var cache = this.cache;
		var attributes = cache[_id];
		if(!attributes){
			attributes = cache[_id] = {};
		}
		attributes[sAttrName.toUpperCase()] = sAttrValue;
	},
	getAttribute : function(element, sAttrName){
		element = $(element);
		if(!element) return null;
		var _id = this.getId(element);
		var cache = this.cache;
		var attributes = cache[_id];
		if(!attributes){
			return null;
		}
		return attributes[sAttrName.toUpperCase()];
	},
	removeAttribute : function(element, sAttrName){
		element = $(element);
		if(!element) return;
		var _id = this.getId(element);
		var cache = this.cache;
		var attributes = cache[_id];
		if(!attributes){
			return;
		}
		delete attributes[sAttrName.toUpperCase()];
	},
	getId : function(element){
		var _id = element.getAttribute("_id");
		if(_id != undefined) return _id;
		_id = element.name || element.id || (this.prefix + (++this.autoId));
		_id = _id.toUpperCase();
		element.setAttribute("_id", _id);
		return _id;
	}
};

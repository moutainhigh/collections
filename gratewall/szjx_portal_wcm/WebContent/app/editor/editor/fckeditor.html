<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
            "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>FCKeditor</title>
<meta name="robots" content="noindex, nofollow" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Cache-Control" content="public" />
<link rel="stylesheet" type="text/css" href="../../css/wcm-common.css">
<script src="../../js/easyversion/lightbase.js"></script>
<script src="../../js/easyversion/extrender.js"></script>
<style type="text/css">
.accessibility{background:white;border:1px solid green;padding:4px;position:absolute;left:100px;top:100px;height:80%;overflow:auto;width:500px;z-index:9999990;}
.accessibility_class{padding-right:10px;}
.accessibility_warning{padding-right:10px;}
.accessibility_num{padding-right:10px;}
.accessibility_title{font-size:14px;}
.accessibility_close{font-size:12px;float:right;}
.accessibility li{margin-bottom:10px;}
.accessibility table{margin-top:5px;table-layout:fixed;border-collapse:collapse;}
.accessibility td{overflow:hidden;white-space:nowrap;padding-right:10px;cursor:pointer;}
.FCK__Flash
{
	border: #a9a9a9 1px solid;
	background-position: center center;
	background-image: url(css/images/fck_flashlogo.gif);
	background-repeat: no-repeat;
	width: 80px;
	height: 80px;
}
</style>
</head>
<body>
<script>
	initExtCss();
	function Window_OnResize(){}
	window.onresize = function(){}
	function LoadScript( url, sVersion ){
		url = url + (sVersion?"?Version="+sVersion:'');
		document.write( '<scr' + 'ipt src="' + url + '"><\/scr' + 'ipt>' ) ;
	}
	function LoadCss( url ){
		document.write( '<link href="' + url + '" type="text/css" rel="stylesheet"/>' ) ;
	}
	// Main editor scripts.
	var sSuffix = Ext.isIE ? 'ie' : 'gecko' ;
	LoadScript( 'js/fckeditorcode_' + sSuffix + '.js' ) ;
	var m_sConfigFile = getParameter('ConfigEx') || '../fckconfig.js';
	LoadScript(m_sConfigFile, getParameter('Version'));
	if(Ext.isGecko){
		document.write('<style>iframe{overflow:auto;}</style>');
	}
</script>
<div id="container" class="layout_container">
	<div id="xToolbarRow" class="layout_north editor_toolbar">
		<table cellpadding="0" cellspacing="0" style="width:100%;background:transparent;">
			<tr id="xCollapsed" style="display: none">
				<td id="xExpandHandle" class="TB_Expand" colspan="3"></td>
			</tr>
			<tr id="xExpanded" style="display: none">
				<td id="xTBLeftBorder" class="TB_SideBorder" style="width: 0px; display: none;"></td>
				<td id="xCollapseHandle" style="display: none" class="TB_Collapse" valign="bottom"></td>
				<td id="xToolbar" class="TB_ToolbarSet xToolbar" style="width:100%;"></td>
				<td class="TB_SideBorder" style="width: 0px"></td>
			</tr>
		</table>
	</div>
	<div id="editor_body" class="layout_center_container">
		<div class="layout_center">
			<table border=0 cellspacing=0 cellpadding=0 width="100%" height="100%" style="table-layout:fixed;">
				<tr class="top_ruler">
					<td width="13">&nbsp;</td><td>&nbsp;</td>
				</tr>
				<tr align="center" valign="top" style="height:100%">
					<td class="left_ruler" width="13"></td>
					<td class="editor_body" valign="top">
						<div id="xEditingArea">
							
						</div>
					</td>
				</tr>
			</table>
		</div>
	</div>
	<div class="layout_south toolbar_btn_basic" id="btn_container" style="display:none">
		<div id="editor_btn_source" class="toolbar_source" _action="source" fcklang="CODE">代码</div>
		<div id="editor_btn_design" class="toolbar_design toolbar_current_btn" _action="design" fcklang="DESIGN">设计</div>
		<div style="margin:0 5px;float:left;" id="spt">|</div>
		<div id="btns_ctn"></div>
	</div>
</div>
<script>
	// Main editor scripts.
	var sSuffix = Ext.isIE ? 'ie' : 'gecko' ;
	LoadScript( 'js/fckeditorcode_' + sSuffix + '.js' ) ;
	var m_sConfigFile = getParameter('ConfigEx') || '../fckconfig.js';
	LoadScript(m_sConfigFile, getParameter('Version'));
</script>
<script src="lang/cn.js" WCMAnt:locale="lang/$locale$.js"></script>
<script language="javascript">
	FCKConfig.ProcessHiddenField() ;
	FCKConfig_LoadPageConfig() ;
	FCKConfig_PreProcess() ;
	LoadScript( '../fckeditor_ex.js', getParameter('Version')) ;
</script>
<script language="javascript">
    Element.update('editor_btn_source', FCKLang.CODE);
    Element.update('editor_btn_design', FCKLang.DESIGN);
	var arr= [
			'clearstyle', "", FCKLang.TIP2,
			'clearclasses', "", FCKLang.TIP4,
			'clearblank', "", FCKLang.TIP5,
			'outdentpara', "",FCKLang.TIP6,
			'replacenbsps', "", FCKLang.TIP7,
			'db2sb', "", FCKLang.TIP9
	];
	if(Ext.isIE){
		arr.push(
			'pasteasplain', FCKLang.TIP10,FCKLang.TIP11
		);
	}



	var rst = [];
	for(var i=0,n=arr.length;i<n;i+=3){
		rst.push('<div unselectable="on" class="btn" _action="' + arr[i] + '">' + 
			'<div unselectable="on" class="btn_inner"' + 
			' title="' + arr[i+1] + '">' + arr[i+2] + '</div>' + 
			'</div>');
	}
	$('btns_ctn').innerHTML = rst.join('');
</script>
<script type="text/javascript">
	LoadScript( 'js/plugins.js', getParameter('Version')) ;
	if ( FCKBrowserInfo.IsIE ){
		// Create the default cleanup object used by the editor.
		FCK.IECleanup = new FCKIECleanup( window ) ;
		FCK.IECleanup.AddItem( FCKTempBin, FCKTempBin.Reset ) ;
		FCK.IECleanup.AddItem( FCK, FCK_Cleanup ) ;
	}
	LoadCss( FCKConfig.SkinPath + 'fck_editor.css' ) ;
	if(getParameter('Css')){
		FCKConfig.EditorAreaCSS = Ext.isArray(FCKConfig.EditorAreaCSS) ? 
					FCKConfig.EditorAreaCSS : [FCKConfig.EditorAreaCSS];
		FCKConfig.EditorAreaCSS.push(FCKConfig.BasePath + 'css/' + getParameter('Css'));
	}	
	FCK_ContextMenu_Init() ;
	FCKPlugins.Load() ;
	window.document.dir = FCKLang.Dir ;
	if ( FCKConfig.ForcePasteAsPlainText || FCKConfig.AutoDetectPasteFromWord )
		FCK.Events.AttachEvent( 'OnPaste', FCK.Paste ) ;
	Event.observe(window, 'load', function(){
		FCKeditorAPI = parent.FCKeditorAPI;
		FCKeditorAPI.editorWindow = window;
		FCKeditorAPI.__Instances[ FCK.Name ] = FCK ;
		if ( FCKBrowserInfo.IsIE )
			FCK_PreloadImages() ;
		else
			LoadToolbarSetup() ;
	});
	function LoadToolbarSetup(){
		FCKeditorAPI._FunctionQueue.Add( LoadToolbar ) ;
	}
	function LoadToolbar(){
		var oToolbarSet = FCK.ToolbarSet 
			= FCKToolbarSet_Create(FCKURLParams['ToolbarLocation']) ;
		if ( oToolbarSet.IsLoaded )
			StartEditor() ;
		else{
			oToolbarSet.OnLoad = StartEditor ;
			oToolbarSet.Load( FCKURLParams['Toolbar'] || 'Default' ) ;
		}
	}
	function StartEditor(){
		FCK.ToolbarSet.OnLoad = null ;
		FCKeditorAPI._FunctionQueue.Remove( LoadToolbar ) ;
		FCK.Events.AttachEvent( 'OnStatusChange', WaitForActive ) ;
		// Start the editor.
		FCK.StartEditor() ;
	}
	function WaitForActive( editorInstance, newStatus ){
		if ( newStatus == FCK_STATUS_ACTIVE ){
			_AttachFormSubmitToAPI() ;
			FCK.SetStatus( FCK_STATUS_COMPLETE ) ;
			if ( typeof( window.parent.FCKeditor_OnComplete ) == 'function' )
				window.parent.FCKeditor_OnComplete( FCK ) ;
		}
	}
</script>
<script src="fckeditor.js"></script>
<script src="../wcag2.js"></script>
<script>
	if(Ext.isIE && window.OfficeActiveX && OfficeActiveX.IsEnableWordClient()){
		OfficeActiveX.Init();
	}
	Element.show('btn_container');
</script>
</body>
</html>

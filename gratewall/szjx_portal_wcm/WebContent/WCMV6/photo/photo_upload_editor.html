<html xmlns:TRS_UI>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>TRS WCM V6 图片库图片上传</title>
  <link href="../css/common.css" rel="stylesheet" type="text/css" />
	<style>
		.simpletab{
			padding-bottom:23px;
			border-bottom:1px solid gray;
			font-size:12px;
		}
		div.simpletab_item{
			float:left;
			width:60px;
			height:20px;
			background:gray;
			margin-left:4px;
			border:1px solid gray;
			padding:4px;
			text-align:center;
		}
		.simpletab_item a,.simpletab_item a:link,.simpletab_item a:visited,.simpletab_item a:hover{
			text-decoration: none;
			color:white;
		}
		div.simpletab_item_active{
			float:left;
			width:60px;
			height:21px;
			background:#ffffff;
			margin-left:4px;
			border:1px solid gray;
			border-bottom:0;
			padding:4px;
			padding-bottom:5px;
			text-align:center;
		}
		.simpletab_item_active a,.simpletab_item_active a:link,.simpletab_item_active a:visited,.simpletab_item_active a:hover{
			text-decoration: none;
			color:black;
		}
		.simpletab_item_before{
			float:left;
			padding-left:20px;
		}
		.message {
			font-family: "宋体", "Arial", "Courier New";
			font-size: 12px;
			float:left;
			height:18px;
			line-height:18px;
		}
		.input_file{
			float:left;
			width:200px;
			height:20px;
			border:1px solid black;	
			margin-top:2px;
		}
		.input_text{
			height:20px;
			border:1px solid black;
			margin:0 1px;
		}
		.input_button{
			width:60px;
			height:20px;
			border:1px solid black;
		}
		.input_select{
			height:16px;
			border:1px solid black;
			margin:0 1px;
		}
		.preview_head{
			font-weight:bold;
			color:green;
			font-size:14px;
		}
		.preview_data{
			line-height:130%;
			width:260px;
			height:207px;
			overflow:auto;
			border:1px solid black;
			padding:3px;
		}
		.ui_select{
			border:1px solid green;
			text-indent:5px;
			border-width:0 0 1px;
		}
		.ui_select_selected,.ui_select_hover{
			border:1px solid black;
		}
		.attr_name{
			height:22px;
			padding-top:4px;
			font-weight:bold;						
		}
		fieldset{			
			padding-left:5px;
		}
		legend{
			font-weight:bold;
			color:#039;
			padding:5px;
		}
		.invalid_file{
			border:1px solid red;
		}
	</style>
	<script src="../js/com.trs.util/Common.js"></script>	
	<script label="TagParser">
//	$import('com.trs.ajaxframe.TagParser');
	$import('com.trs.web2frame.DataHelper');
	$import('com.trs.web2frame.TempEvaler');
	$import('com.trs.wcm.Web2frameDefault');
	$import('com.trs.dialog.Dialog');
	</script>
	<script label="UITransformer">
		$import('com.trs.util.UITransformer');
	</script>
	<script>
		$import('com.trs.wcm.MessageCenter');
		$import('com.trs.wcm.ProcessBar');
		$import('com.trs.wcm.util.FileUploadHelper');
		$import('com.trs.util.YUIConnection');
		$import('com.trs.validator.Validator');
	</script>	
	<script src="photo_upload_editor.js"></script>
	<style type="text/css">
		body{
			background:#ccc;
		}
		.quoto_kind{
			height:100px;
			width:150px;
			border:1px solid gray;
		}
body td{
	font-size:12px;
}
.attr_table{
	width:100%;
	overflow:auto;
}
.add_quotekind{
	float:right;
	width:17px;
	height:20px;
	margin-right:5px;
	background:url(../images/document_addedit/add_quotechannel.gif) no-repeat center center;
}
.remove_quotekind{
	float:right;
	width:17px;
	height:20px;
	margin-right:15px;
	background:url(../images/document_addedit/remove_quotechannel.gif) no-repeat center center;
}
.attr_quotekind_head{
	background:gray;
	color:white;
	height:22px;
}
.attr_quotekind_row{
	background:#FFFFFF;
	height:20px;
}
.attr_quotekind_column{
	overflow:hidden;
	text-align:left;
}
.button{
	margin:0 5px;
	width:80px;
	border:1px solid gray;
	height:20px;
	text-align:center;
	padding-top:2px;
}
	</style>
</head>
<body>
<table width="500"  border="0" style="font-size:12px">
  <tr>
    <td width="200" valign="top">
	<fieldset style="width:220px;height:324px;"><legend>选择图片</legend>
		<table width="100%" border="0" height="100%">        
		<tr>
		  <td style="font-size:12px" valign="top" height="40">
		    上传图片数目<input type="text" class="input_text" style="width:20px;margin:0 5px" id="picnum" value="1" validation="type:'int',min:'1',max:'10',desc:'上传数目'"/><input type="button" class="input_button" style="width:40px;" value="OK" id="picnumbtn" /><br>
			<label for="batchupload" style="margin-left:-2px;cursor:hand"><input type="checkbox" id="batchupload"/>批量导入(*.zip)</label>
		  </td>
		</tr>
		<tr>
			<td valign="top">
				<div class="message">选择本地图片文件：</div><br>
				<div>
				<form id="form_pic0" name="fm_pic0" style="margin:0;" enctype='multipart/form-data' onsubmit="Ok();return false;">
					<input type="file" class="input_file" id="PicUpload" name="PicUpload" onchange="this.className='input_file';">
				</form>
				</div>
				<form id="form_imageInfo">
					<input type="hidden" name="MainKindId" id="MainKindId" value="0"></input>
					<input type="hidden" name="OtherKindIds" id="OtherKindIds" value=""></input>
					<input type="hidden" name="WatermarkFile" id="WatermarkFile" value="0"></input>
					<input type="hidden" name="WatermarkPos" id="WatermarkPos" value=""></input>	
					<input type="hidden" name="UploadedFiles" id="UploadedFiles" value=""></input>
					<input type="hidden" name="SourceFiles" id="SourceFiles" value=""></input>
					<input type="hidden" name="BatchMode" id="BatchMode" value="0"></input>
					<input type="hidden" name="BmpConverType" id="BmpConverType" value=""></input>
				</form>
			</td>			
		</tr>	     
      </table>
	</fieldset>
	<table border=0 cellspacing=0 cellpadding=0 width="100%">
	<tbody>
		<tr height="30">
			<td valign="middle" align="center">
				<button onclick="Ok();" class="button">确定</button><button onclick="window.close();" class="button">取消</button>
			</td>
		</tr>
	</tbody>
	</table>
	</td>
    <td width="300" valign="top">
	<fieldset style="width:300px;height:356px;"><legend>图片属性</legend>
		<table style="font-size:12px;table-layout:fixed" width="100%" border="0" height="100%">       
        <tr>
          <td colspan="2" height="22">
			<span class="attr_name">主分类：</span>
			<span id="mainkind" style="line-height:22px;height:22px;white-space:nowrap;overflow:hidden;width:220px;"></span>
			<textarea id="template_mainkind" style="display:none" select="Channel">			
				<div id="_mainkind" style="cursor:hand;color:#483d8b;" _mainkindId="{#ChannelId}" _siteId="{#Site.Id}">{#ChnlDesc}</div>
			</textarea>
          </td>
        </tr>		
		<tr height="44">
          <td colspan="2">
			<span class="attr_name">BMP图片转换格式：</span><br>
			<select onchange="convertBmp(this);" id="BmpConverTypeSelect">
				<option value="bmp">不转换</option>
				<option value="gif">GIF</option>
				<option value="jpg">JPG</option>
			</select>
          </td>
        </tr>
		<tr>
          <td colspan="2" height="136">
			<div style="width:100%;height:22px;">
				<span class="attr_name" style="width:120px;height:22px;float:left;">引用到其它分类：</span>
				<span class="remove_quotekind wcm_pointer" onClick="RemoveSelectedQuoteKind();" title="移除选中的引用分类"></span>
				<span class="add_quotekind wcm_pointer" onClick="AddQuoteKind();" title="增加引用分类"></span>
			</div>
			<div class="attr_table" style="height:110px">
				<TABLE cellSpacing=1 cellPadding=2 width="100%" style="height:110px" bgColor="black" border=0 style="font-size:12px;" id="QuoteKinds" ChannelIds="">
				<THEAD>
					<TR align="center" valign="middle" class="attr_quotekind_head">
						<TD style="width:24px;cursor:pointer;" onclick="SelectAllQuoteKinds();">全选</TD>
						<TD>分类名称</TD>
					</TR>
				</THEAD>
				<TBODY id="otherkinds_holder" style="cursor:pointer;">
					<TR class='attr_quotekind_row' valign='middle'>
						<TD>
							<input type='checkbox' name='cb_quotekind' value='0' disabled>
						</TD>
						<TD class='attr_quotekind_column'>
						</TD>
					</TR>
				</TBODY>
				<TBODY>
					<TR bgColor="white">
						<TD colspan="2">
						</TD>
					</TR>
				</TBODY>
				</TABLE>
			</div>
			<textarea id="template_otherkinds" style="display:none">
				<for select="Channels.Channel">
					<TR class='attr_quotechanel_row' valign='middle'>
						<TD>
							<input type='checkbox' name='cb_quotekind' value='{#ChannelId}' disabled>
						</TD>
						<TD class='attr_quotekind_column'>{#ChnlDesc}
						</TD>
					</TR>
				</for>
			</select>
			</textarea>
          </td>
        </tr>
		<tr valign="top">
          <td width="160">
			<span class="attr_name">选择水印：</span><br>
			<span id="watermarks" style="height:26px;"></span><br>
			<textarea style="display:none" id="template_watermarks">
				<select id="selwatermark" style="width:120px;">
					<option value="-1">--不添加水印--</option>
				<for select="Watermarks.Watermark">
					<option value="{#WATERMARKID}" _picsrc="{#WMPICTURE.MAPNAME}" _picfile="{#WMPICTURE.SRCNAME}">{#WMNAME}</option>
				</for>
				</select>
			</textarea>			
			<div id="div_watermarkpos" style="display:none">
				<span class="attr_name" title="点击全选" style="cursor:hand" onclick="selectAllPos()">水印位置：</span><br>
				<label for="LT" style="height:22px;">左上<input type="checkbox" id="LT" value="1"/></label>
				<label for="CM" style="height:22px;">居中<input type="checkbox" id="CM" value="2"/></label>
				<label for="RB" style="height:22px;">右下<input type="checkbox" id="RB" value="3" checked/></label>
			</div>			
          </td>
		  <td>
			<img src="../images/photo/nostamp.gif"  style="display:none" id="watermarkpic" width="90">
		  </td>
        </tr>
      </table>
	</fieldset>
	</td>
  </tr>
</table>
</body>
</html>
